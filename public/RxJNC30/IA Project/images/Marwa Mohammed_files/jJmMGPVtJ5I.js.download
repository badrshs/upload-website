if (self.CavalryLogger) { CavalryLogger.start_js(["D7t+i"]); }

__d("AppInstallLoggerEvents",[],(function a(b,c,d,e,f,g){f.exports={IMPRESSION:"impression",CLICK:"click",INSTALL:"install",XOUT:"xout",RANKED_IMPRESSION:"ranked_impression",CANVAS_VISIT:"canvas_visit",APP_SESSION_START:"session_start",CANVAS_IFRAME_LOAD:"canvas_iframe_load",APP_POPOVER_RENDER:"app_popover_render",APP_PAGE_RENDER:"app_page_render",APPCENTER_MENU_RENDER:"appcenter_menu_render",APPCENTER_HOMEPAGE_RENDER:"appcenter_homepage_render",APPCENTER_MANAGE_RENDER:"appcenter_manage_render",APPCENTER_REQUESTS_RENDER:"appcenter_requests_render",APPCENTER_INVITES_RENDER:"appcenter_invites_render",APPCENTER_TOP_LISTS_RENDER:"appcenter_top_lists_render",APPCENTER_QUERY_RESULTS_RENDER:"appcenter_query_results_render",GAMES_LOGIN_PAGE_ONE_RENDER:"games_login_page_one_render",GAMES_LOGIN_PAGE_TWO_RENDER:"games_login_page_two_render",GAMES_LOGIN_PAGE_ONE_XOUT:"games_login_page_one_xout",GAMES_LOGIN_PAGE_TWO_XOUT:"games_login_page_two_xout",GAMES_LOGIN_NEXT_PAGE:"games_login_next_page",GAMES_LOGIN_PREV_PAGE:"games_login_prev_page",GAMES_LOGIN_SOCIAL_LOGIN:"games_login_social_login",GAMES_LOGIN_SOCIAL_LOGIN_SUCCESS:"games_login_social_login_success",GAMES_LOGIN_SINGLE_ANONYMOUS_LOGIN:"games_login_single_anonymous_login",GAMES_LOGIN_ALWAYS_ANONYMOUS_LOGIN:"games_login_always_anonymous_login",GAMES_LOGIN_AUTO_LOGIN:"games_login_auto_login",GAMES_LOGIN_UNSIGNED_RENDER:"games_login_unsigned_render",GAMES_LOGIN_UNSIGNED_SOCIAL_LOGIN:"games_login_unsigned_social_login",GAMES_LOGIN_UNSIGNED_ANONYMOUS_LOGIN:"games_login_unsigned_anonymous_login",GAMES_LOGIN_UNSIGNED_XOUT:"games_login_unsigned_xout",GAMES_LOGIN_LEARN_MORE_CLICK:"games_login_learn_more",GAMES_LOGIN_EDIT_SETTINGS:"games_login_edit_settings",GAMES_LOGIN_SOCIAL_UPGRADE_BUTTON_CLICK:"games_login_social_upgrade_button_click",GAMES_LOGIN_SOCIAL_UPGRADE_IMPRESSION:"games_login_social_upgrade_impression",GAMES_LOGIN_SOCIAL_UPGRADE_SUCCESS:"games_login_social_upgrade_success",GAMES_LOGIN_XOUT_SOCIAL_IMPRESSION:"games_login_xout_social_impression",GDPV4_RENDER:"gdpv4_render",GDPV4_EDITED_SCOPES:"gdpv4_edit_scopes",GDPV4_BUTTON_CLICK:"gdpv4_button_click",CLICK_TO_APPCENTER:"click_to_appcenter",PP_CREATE_INVITE:"pp_create_invite",PP_ACCEPT_INVITE:"pp_accept_invite",PP_DELETE_INVITES:"pp_delete_invites",PP_DELETE_ALL:"pp_delete_all",PP_BLOCK_APP:"pp_block_app",PP_BLOCK_USER:"pp_block_user",PP_UNBLOCK_APP:"pp_unblock_app",PP_UNBLOCK_USER:"pp_unblock_user",PP_ACCEPT_INVITE_ACTIVATE_APP:"pp_accept_invite_activate_app",GAMERANKER_REQUEST:"gameranker_request",GAMERANKER_RESPONSE:"gameranker_response",GAMERANKER_EXCEPTION:"gameranker_exception",GAMERANKER_TARGETING_SCORE:"gameranker_targeting_score",GAME_COLLABORATIVE_FILTERING_SCORE:"game_collaborative_filtering_score",NOTIFICATION_CONTENT_UPDATE_SEND:"notification_content_update_send",NOTIFICATION_CONTENT_UPDATE_SEND_TO_TURNOFF:"notification_content_update_send_to_turnoff",NOTIFICATION_CONTENT_UPDATE_CLICK:"notification_content_update_click",NOTIFICATION_CONTENT_UPDATE_IMPRESSION:"notification_content_update_impression",NOTIFICATION_CONTENT_UPDATE_TURN_OFF:"notification_content_update_turn_off",NOTIFICATION_CONTENT_UPDATE_UNDO_TURN_OFF:"notification_content_update_undo_turn_off",NOTIFICATION_CONTENT_UPDATE_MARK_SPAM:"notification_content_update_mark_spam",NOTIFICATION_CONTENT_UPDATE_FIRST_IMPRESSION:"notification_content_update_first_impression",NOTIFICATION_CONTENT_UPDATE_FIRST_YES:"notification_content_update_first_yes",NOTIFICATION_CONTENT_UPDATE_FIRST_IMPLICIT_YES:"notification_content_update_first_implicit_yes",NOTIFICATION_CONTENT_UPDATE_FIRST_NO:"notification_content_update_first_no",NOTIFICATION_A2U_SEND:"notification_a2u_send",NOTIFICATION_A2U_SEND_TO_TURNOFF:"notification_a2u_send_to_turnoff",NOTIFICATION_A2U_CLICK:"notification_a2u_click",NOTIFICATION_A2U_IMPRESSION:"notification_a2u_impression",NOTIFICATION_A2U_TURN_OFF:"notification_a2u_turn_off",NOTIFICATION_A2U_UNDO_TURN_OFF:"notification_a2u_undo_turn_off",NOTIFICATION_A2U_MARK_SPAM:"notification_a2u_mark_spam",NOTIFICATION_A2U_FIRST_IMPRESSION:"notification_a2u_first_impression",NOTIFICATION_A2U_FIRST_YES:"notification_a2u_first_yes",NOTIFICATION_GYML_EVALUATION:"notification_a2u_gyml_evaluation",LIVE_PLAYER_NOTIFICATION_SENT:"live_player_notification_sent",LIVE_PLAYER_NOTIFICATION_SEND_ATTEMPT:"live_player_notification_send_attempt",GAMER_CHAT_MESSAGE_SEND:"gamer_chat_message_send",GAMER_CHAT_MESSAGE_SENTRY_BLOCKED:"gamer_chat_message_sentry_blocked",GAMER_CHAT_MESSAGE_HIDDEN:"gamer_chat_message_hidden",GAMER_CHAT_MESSAGE_UNHIDDEN:"gamer_chat_message_unhidden",GAMER_CHAT_MESSAGE_SENDER_BLOCKED:"gamer_chat_message_blocked",GAMER_CHAT_MESSAGE_SENDER_UNBLOCKED:"gamer_chat_message_unblocked",GAMER_CHAT_MESSAGE_SENDER_REPORTED:"gamer_chat_message_reported",GAMER_CHAT_USER_BANNED:"gamer_chat_user_banned",GAMER_CHAT_USER_UNBANNED:"gamer_chat_user_unbanned",GAME_GROUP_CREATE_DIALOG_OPENED:"game_group_create_dialog_opened",GAME_GROUP_CREATED:"game_group_created",GAME_GROUP_CREATE_ATTEMPT:"game_group_create_attempt",GAME_GROUP_JOIN_DIALOG_OPENED:"game_group_join_dialog_opened",GAME_GROUP_JOINED:"game_group_joined",GAME_ACHIEVEMENT_EARNED:"game_achievement_earned",RHC_SETTINGS_UNIT_APP_FAVORITED:"rhc_settings_unit_app_favorited",RHC_SETTINGS_UNIT_APP_UNFAVORITED:"rhc_settings_unit_app_unfavorited",RHC_SETTINGS_UNIT_APP_SHARE_CLICKED:"rhc_settings_unit_app_share_clicked",RHC_SETTINGS_UNIT_APP_PRIVACY_SETTINGS_CLICKED:"rhc_settings_unit_app_privacy_settings_clicked",RHC_SETTINGS_UNIT_APP_UNINSTALL_CLICKED:"rhc_settings_unit_app_uninstall_clicked",RHC_SETTINGS_UNIT_APP_FULLSCREENED:"rhc_settings_unit_app_fullscreened",GYML_REQUEST:"gyml_request",GYML_ERROR:"gyml_error",GYML_NO_MODEL:"gyml_no_model",GYML_RESULT:"gyml_result",GAMES_DESKTOP_EXCEPTION:"games_desktop_exception",GAMES_DESKTOP_MAIN_FRAME_URL:"games_desktop_main_frame_url",GAMES_DESKTOP_OPENED_APP:"games_desktop_opened_app",GAMES_DESKTOP_UPDATE_STEP:"games_desktop_update_step",GAMES_DESKTOP_APP_INSTALLED:"games_desktop_app_installed",GAMES_DESKTOP_CONTROL_USED:"games_desktop_control_used",GAMES_DESKTOP_GAME_SHORTCUT_USED:"games_desktop_game_shortcut_used",GAMES_DESKTOP_GAME_SHORTCUT_CREATED:"games_desktop_game_shortcut_created",GAMES_DESKTOP_LOGGED_IN:"games_desktop_logged_in",GAMES_DESKTOP_LOGGED_OUT:"games_desktop_logged_out",GAMES_DESKTOP_FLASH_NOT_INSTALLED:"games_desktop_flash_not_installed",GAMES_DESKTOP_APP_DOWNLOADED:"games_desktop_app_downloaded",GAMES_DESKTOP_APP_DOWNLOAD_UNIT_IMPRESSION:"games_desktop_app_download_unit_impression",GAMES_DESKTOP_APP_UNINSTALLED:"games_desktop_app_uninstalled",GAMES_DESKTOP_LEARN_MORE_DIALOG_IMPRESSION:"games_desktop_learn_more_dialog_impression",GAMES_DESKTOP_FEEDBACK:"games_desktop_feedback",GAMES_DESKTOP_APP_UNINSTALLED_FAILED_CHECK:"games_desktop_app_uninstalled_failed_check",GAMES_DESKTOP_CLOSED_APP:"games_desktop_closed_app",GAMES_DESKTOP_RENDER_PROCESS_TERMINATED:"games_desktop_render_process_terminated",GAMES_DESKTOP_NONCE_CREATION_FAILED:"games_desktop_nonce_creation_failed",GAMES_DESKTOP_AUTO_LOGIN_FAILED:"games_desktop_auto_login_failed",GAMES_DESKTOP_AUTO_LOGIN_SUCCEEDED:"games_desktop_auto_login_succeeded",GAMES_DESKTOP_TOAST_EVENT:"games_desktop_toast_event",GAMES_DESKTOP_NOTIF_ACTION:"games_desktop_notif_action",GAMES_DESKTOP_AUTO_LOGIN_AVAILABLE:"games_desktop_auto_login_available",GAMES_DESKTOP_SETTINGS_CHANGE:"games_desktop_settings_change",GAMES_DESKTOP_LANDING_PAGE_VIEW:"games_desktop_landing_page_view",GAMES_DESKTOP_LANDING_PAGE_MOBILE_VIEW:"games_desktop_landing_page_mobile_view",GAMES_DESKTOP_SYSTEM_PERFORMANCE:"games_desktop_system_performance",GAMES_DESKTOP_DOWNLOADER_STATE:"games_desktop_downloader_state",GAMES_DESKTOP_DOWNLOADER_EXCEPTION:"games_desktop_downloader_exception",GAMES_DESKTOP_LOAD_ERROR:"games_desktop_load_error",GAMES_DESKTOP_NOTIF_POLL:"games_desktop_notif_poll",GAMES_DESKTOP_NATIVE_GAME_STATE:"games_desktop_native_game_state",GAMES_DESKTOP_HARDWARE_DATA:"games_desktop_hardware_data",GAMES_DESKTOP_CAN_INTERACT:"games_desktop_can_interact",GAMES_DESKTOP_BROWSER_INITIALIZED:"games_desktop_browser_initialized",ARCADE_USER_DROPDOWN_CLICK:"arcade_user_dropdown_click",ARCADE_ABOUT_VIEW_CLICK:"arcade_about_view_click",ARCADE_CONTACT_FORM_CLICK:"arcade_contact_form_click",ARCADE_BB_NOTIFICATIONS_CLICK:"arcade_bb_notifications_click",ARCADE_LHC_BROWSE_CLICK:"arcade_lhc_browse_click",ARCADE_LHC_GO_LIVE_CLICK:"arcade_lhc_go_live_click",ARCADE_LHC_WATCH_CLICK:"arcade_lhc_watch_click",ARCADE_LHC_MYGAMES_CLICK:"arcade_lhc_mygames_click",ARCADE_LHC_FEED_CLICK:"arcade_lhc_feed_click",ARCADE_MYGAMES_DD_CLICK_DETAILS:"arcade_mygames_dd_click_details",ARCADE_MYGAMES_DD_CLICK_FOOTER:"arcade_mygames_dd_click_footer",ARCADE_HOMEPAGE_DD_CLICK_DETAILS:"arcade_homepage_dd_click_details",ARCADE_HOMEPAGE_DD_CLICK_FOOTER:"arcade_homepage_dd_click_footer",ARCADE_SEARCH_DD_CLICK_DETAILS:"arcade_search_dd_click_details",ARCADE_SEARCH_DD_CLICK_FOOTER:"arcade_search_dd_click_footer",ARCADE_GAMETILE_GAMETAG_CLICK:"arcade_gametile_gametag_click",ARCADE_GAMETILE_XOUT_CLICK:"arcade_gametile_xout_click",ARCADE_DD_XOUT_CLICK:"arcade_dd_xout_click",ARCADE_DD_PLAYNOW_CLICK:"arcade_dd_playnow_click",ARCADE_DD_GAME_UNSAVED:"arcade_dd_game_unsaved",ARCADE_DD_GAME_SAVED:"arcade_dd_game_saved",ARCADE_DD_SLIDES_CLICK_RIGHT:"arcade_dd_slides_click_right",ARCADE_DD_SLIDES_CLICK_LEFT:"arcade_dd_slides_click_left",ARCADE_DD_SCREENSHOT_CLICK:"arcade_dd_screenshot_click",ARCADE_WELCOME_OVERLAY_IMPRESSION:"arcade_welcome_overlay_impression",ARCADE_NUX_TOUR_DISMISSED:"arcade_nux_tour_dismissed",ARCADE_NUX_TOUR_STARTED:"arcade_nux_tour_started",ARCADE_NUX_TOUR_COMPLETED:"arcade_nux_tour_completed",ARCADE_AUTOMATIC_GAME_LAUNCH:"arcade_automatic_game_launch",ARCADE_LIVESTREAM_CLICK:"arcade_livestream_click",ARCADE_LIVESTREAM_IMPRESSION:"arcade_livestream_impression",ARCADE_LIVESTREAM_MOUSEOVER:"arcade_livestream_mouseover",ARCADE_LIVESTREAM_WATCH_TIME:"arcade_livestream_watch_time",GAMES_RATING_PROMPT_CLOSE:"games_rating_prompt_close",GAMES_RATING_PROMPT_RATE:"games_rating_prompt_rate",GAMES_RATING_PROMPT_SHOW:"games_rating_prompt_show",GAMES_RECOMMEND_PROMPT_RECOMMEND:"games_recommend_prompt_recommend",GAMES_RECOMMEND_PROMPT_SHOW:"games_recommend_prompt_show",GAMES_RECOMMEND_PROMPT_CLOSE:"games_recommend_prompt_close",GIULIANI_REPORT_SUBMITTED:"giuliani_report_submitted",CHANGED_APPCENTER_APPROVED_STATE:"changed_appcenter_approved_state",RESTRICTED_ORGANIC_RECOMMENDATIONS:"restricted_organic_recommendations",FEED_GAMES_DIGEST_SUBSCRIBED:"feed_games_digest_subscribe",FEED_GAMES_DIGEST_UNSUBSCRIBED:"feed_games_digest_unsubscribe",GAME_PLAYED_5S:"game_played_5s",GAME_PLAYED_10S:"game_played_10s",GAME_PLAYED_30S:"game_played_30s",GAME_PLAYED_1M:"game_played_1m",GAME_PLAYED_2M:"game_played_2m",GAME_PLAYED_5M:"game_played_5m",ARCADE_MIGRATION_PAGE_LOADED:"arcade_migration_page_loaded",ARCADE_MIGRATION_LAUNCH_CLICKED:"arcade_migration_launch_clicked",ARCADE_MIGRATION_MANUAL_BYPASS:"arcade_migration_manual_bypass",ARCADE_MIGRATION_AUTO_BYPASS:"arcade_migration_auto_bypass",GAME_TAB_REC_GRID_CONTENT_REQUESTED:"game_tab_rec_grid_content_requested",IMAGE_ASSET_CLICK:"image_asset_click",IMAGE_ASSET_IMPRESSION:"image_asset_impression",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",THROTTLED_CANVAS_VISIT:"throttled_canvas_visit",THROTTLED_APPCENTER_VISIT:"throttled_appcenter_visit",THROTTLED_OAUTH_VISIT:"throttled_oauth_visit",CHAINED_ARTICLE_APP_CENTER_IMPRESSION:"chained_article_app_center_impression",GAMES_UNHANDLED_JS_EXCEPTION:"games_unhandled_js_exception"};}),null);
__d('AppInstallLogger',['AppInstallLoggerEvents','Banzai','ErrorUtils'],(function a(b,c,d,e,f,g){var h='app_install';i.prototype.init=function(){'use strict';c('ErrorUtils').addListener(function(j){var k={error_message:j.message,error_type:j.name,error_data:JSON.stringify(j),stack_trace:j.stack};this.log(c('AppInstallLoggerEvents').GAMES_UNHANDLED_JS_EXCEPTION,null,k);}.bind(this));};i.prototype.log=function(event,j,k){'use strict';c('Banzai').post(h,babelHelpers['extends']({app_id:j,event:event},k||{}));};function i(){'use strict';}f.exports=new i();}),null);
__d('XdArbiterBuffer',[],(function a(b,c,d,e,f,g){if(!b.XdArbiter)b.XdArbiter={_m:[],_p:[],register:function h(i,j,k){j=j||(/^apps\./.test(location.hostname)?'canvas':'tab');this._p.push([i,j,k]);return j;},handleMessage:function h(i,j){this._m.push([i,j]);}};}),null);
__d('CanvasIFrameLoader',['XdArbiterBuffer','Banzai','$'],(function a(b,c,d,e,f,g){c('XdArbiterBuffer');var h={loadFromForm:function j(k,l,m){var n=c('$')('iframe_canvas');if(l&&!i()){l.style.display='block';n.style.display='none';return;}var o=Date.now();n.onload=function(){var p=Date.now(),q=p-o;c('Banzai').post('canvas_iframe_load',{app_id:m,iframe_time_to_load:q});};k.submit();}};function i(){try{var k=document.createElement('canvas');return Boolean(window.WebGLRenderingContext)&&Boolean(k.getContext('webgl')||k.getContext('experimental-webgl'));}catch(j){return false;}}f.exports=h;}),null);
__d('PlatformElementXOut.react',['AsyncRequest','DOM','DOMContainer.react','GamesXOut.react','React','ReactDOM','XPlatformXOutableElementController'],(function a(b,c,d,e,f,g){var h,i,j=c('React').PropTypes;h=babelHelpers.inherits(k,c('React').Component);i=h&&h.prototype;function k(){var l,m;'use strict';for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return m=(l=i.constructor).call.apply(l,[this].concat(o)),this.$PlatformElementXOut1=function(){var q=c('XPlatformXOutableElementController').getURIBuilder().setEnum('type',this.props.type).setInt('fbid',this.props.fbid).getURI();new (c('AsyncRequest'))(q).setMethod('POST').send();var r=c('ReactDOM').findDOMNode(this).parentNode.parentNode;c('ReactDOM').unmountComponentAtNode(r);c('DOM').remove(r);}.bind(this),m;}k.prototype.render=function(){'use strict';var l=c('React').createElement(c('DOMContainer.react'),null,this.props.domChild);return c('React').createElement(c('GamesXOut.react'),{onClick:this.$PlatformElementXOut1},l);};k.propTypes={type:j.string.isRequired,fbid:j.string.isRequired,domChild:j.object.isRequired};f.exports=k;}),null);
__d('FacebarResultStoreUtils',['FacebarGlobalOptions','FacebarJSConstants'],(function a(b,c,d,e,f,g){var h={getQueryFeatures:function i(j){var k={};if(c('FacebarGlobalOptions').enableBootstrapRanking){if(j.raw_text)k.FEATURE_QUERY_LENGTH=j.raw_text.length;if(j.tokens){k.FEATURE_QUERY_TOKENS=j.tokens.length;k.FEATURE_QUERY_TOKEN_LENGTH_SUM=0;for(var l=0;l<j.tokens.length;l++)k.FEATURE_QUERY_TOKEN_LENGTH_SUM+=j.tokens[l].length;}}return k;},addFeatures:function i(j,k,l,m,n,o){if(!j.features)return;j.features={FEATURE_QUERY_LENGTH:m.FEATURE_QUERY_LENGTH,FEATURE_QUERY_TOKENS:m.FEATURE_QUERY_TOKENS,FEATURE_QUERY_TOKEN_LENGTH_SUM:m.FEATURE_QUERY_TOKEN_LENGTH_SUM};j.features.FEATURE_IS_EXACT_NAME_MATCH=n;j.features.FEATURE_IS_STOP_WORD_MATCH=o;if(k&&k.length>0){var p=k.split(' ').length,q=0;for(var r=0;r<j.termMatches.length;++r)if(k.search(j.termMatches[r])>=0)q++;j.features.FEATURE_TITLE_TOKEN_MATCH_FRACTION=q/p;}if(l.tokens&&l.tokens.length>0){var s=k.search(l.tokens[0]);j.features.FEATURE_FIRST_TERM_MATCH_POSITION=s;j.features.FEATURE_FIRST_TERM_MATCH_TOKEN=k.substring(0,s+l.tokens[0].length).split(' ').length;j.termMatches.some(function(t){if(t.search(l.tokens[0])===0){j.features.FEATURE_FIRST_TERM_MATCH_TOKEN_FRACTION=l.tokens[0].length/t.length;return true;}return false;});j.features.FEATURE_IN_ORDER_MATCH=1;if(l.tokens.length>1){s=k.search(l.tokens[1]);j.features.FEATURE_SECOND_TERM_MATCH_POSITION=s;j.features.FEATURE_SECOND_TERM_MATCH_TOKEN=k.substring(0,s+l.tokens[1].length).split(' ').length;j.termMatches.some(function(t){if(t.search(l.tokens[1])===0){j.features.FEATURE_FIRST_TERM_MATCH_TOKEN_FRACTION=l.tokens[0].length/t.length;return true;}return false;});if(j.features.FEATURE_SECOND_TERM_MATCH_TOKEN<j.features.FEATURE_FIRST_TERM_MATCH_POSITION)j.features.FEATURE_IN_ORDER_MATCH=0;}}return j;},processEntityResult:function i(j,k,l,m,n,o,p,q,r){var s={semantic:k.toString(),structure:[{type:j===c('FacebarJSConstants').keywordType?j:'ent:'+j,text:l,uid:k}],type:j,cost:m,cache_id_length:0,features:[]};s.tuid=JSON.stringify({semantic:s.semantic,structure:s.structure});if(c('FacebarGlobalOptions').enableBootstrapRanking){s.termMatches=p[k.toString()];s=this.addFeatures(s,l.toLowerCase(),n,o,q,r);}return s;},getRawTextFromStructured:function i(j){var k=j.map(function(l){return l.getText();});return k.join('');},getTextFromResult:function i(j){var k=j.structure,l='';k.forEach(function(m){l+=m.text;});return l;}};f.exports=h;}),null);
__d('HashtagParser',['URLMatcher','getHashtagRegex'],(function a(b,c,d,e,f,g){var h=100,i=30,j=/@\[([0-9]+):([0-9]+):((?:[^\\\]]*(?:\\.)*)*)\]/g;function k(ca){var da=x(ca),ea=0,fa=0;return m(ca).map(function(ga){while(ea<da.length){var ha=da[ea],ia=ha.offset-fa;if(ia<ga.offset){fa+=ha.token.length-ha.name.length;ea++;}else break;}return {marker:ga.marker,tag:ga.hashtag,rawOffset:ga.offset+fa,offset:ga.offset};});}function l(ca){return n(ca,s(ca));}function m(ca){var da=z(ca);return n(da,o(ca,da));}function n(ca,da){return q(ca).slice(0,i).filter(function(ea){var fa=u(ea.offset,ea.hashtag.length,da);return !fa&&ea.hashtag.length<=h;});}function o(ca,da){return t(r(ca),s(da));}var p=c('getHashtagRegex')();function q(ca){var da=[];ca.replace(p,function(ea,fa,ga,ha,ia){da.push({marker:ga,hashtag:ha,offset:ia+fa.length});});return da;}function r(ca){return aa(ca).map(function(da){return [da.offset,da.name.length];});}function s(ca){var da=[],ea,fa=0;while(ea=c('URLMatcher').permissiveMatch(ca)){var ga=ca.indexOf(ea);da.push([fa+ga,ea.length]);ca=ca.substring(ga+ea.length);fa+=ga+ea.length;}return da;}function t(ca,da){var ea=[],fa=0,ga=0,ha=0;while(fa<ca.length&&ga<da.length)if(ca[fa][0]>da[ga][0]){ea[ha++]=da[ga++];}else ea[ha++]=ca[fa++];return ea.concat(ca.slice(fa),da.slice(ga));}function u(ca,da,ea){if(!ea)return false;var fa=w(ea,ca);return v(ca,da,ea,fa)||v(ca,da,ea,fa+1);}function v(ca,da,ea,fa){if(!ea[fa])return false;var ga=ea[fa][0],ha=ea[fa][1];return !(ca+da-1<ga||ca>ga+ha-1);}function w(ca,da){var ea=0,fa=ca.length-1;while(ea<=fa){var ga=Math.floor((ea+fa)/2),ha=ca[ga][0];if(ha==da){return ga;}else if(ha<da){ea=ga+1;}else fa=ga-1;}return fa;}function x(ca){var da=[];ca.replace(j,function(ea,fa,ga,ha,ia){da.push({token:ea,id:fa,type:ga,name:ha,offset:ia});});return da;}function y(ca){return ca?ca.replace(/\\([^\\])/g,'$1').replace(/\\\\/g,'\\'):null;}function z(ca){return ca.replace(j,function(da,ea,fa,ga,ha){return y(ga);});}function aa(ca){var da=0,ea=0;return x(ca).map(function(fa){var ga=ca.indexOf(fa.token,ea);ea=ga+1;ga-=da;var ha=y(fa.name);da+=fa.token.length-ha.length;if(ga>=0)return {id:fa.id,name:ha,type:fa.type,offset:ga};});}var ba={};ba.parse=k;ba.parseWithoutMentions=l;f.exports=ba;}),null);
__d('HashtagSearchResultUtils',['fbt','FacebarResultStoreUtils','HashtagParser','HashtagSearchResultConfig','URI'],(function a(b,c,d,e,f,g,h){var i={getHashtagFromQuery:function j(k){var l=c('HashtagParser').parse(k);if(l&&l.length===1&&l[0].offset===0)return l[0].tag;return false;},makeTypeaheadResult:function j(k){var l=h._("Hashtag");return {category:l,path:new (c('URI'))('/hashtag/'+k).toString(),photo:c('HashtagSearchResultConfig').image_url,rankType:null,replace_results:c('HashtagSearchResultConfig').boost_result?true:false,scaled_score:1,score:0,text:'#'+k,type:'hashtag_exact',uid:'hashtag:'+k};},makeFacebarEntry:function j(k){var l=h._("Hashtag");return {category:l,path:new (c('URI'))('/hashtag/'+k).toString(),photo:c('HashtagSearchResultConfig').image_url,replace_results:c('HashtagSearchResultConfig').boost_result?true:false,text:'#'+k,type:'hashtag_exact',uid:'hashtag:'+k};},makeFacebarResult:function j(k){var l=c('FacebarResultStoreUtils').processEntityResult('hashtag_exact','hashtag:'+k,'#'+k,c('HashtagSearchResultConfig').hashtag_cost);l.parse={display:[{type:'ent:hashtag_exact',uid:'hashtag:'+k}],remTokens:[],suffix:''};l.tags={hashtag:'hashtag'};return l;}};f.exports=i;}),null);
__d('CanvasNavigationFullScreen',['cx','AppInstallLogger','AppInstallLoggerEvents','Arbiter','CSS','Event','FullScreen'],(function a(b,c,d,e,f,g,h){var i=false,j=null,k={initLink:function l(m,n){if(i){return;}else i=true;j=m;c('CSS').conditionClass(n,"_4-os",c('FullScreen').isSupported());c('Event').listen(n,'click',this.setFullScreen.bind(null,true));c('FullScreen').subscribe('changed',function(){if(c('FullScreen').isFullScreen()){c('Arbiter').inform('canvas.enter_fullscreen');}else c('Arbiter').inform('canvas.exit_fullscreen');});},isSupported:function l(){var m=i&&c('FullScreen').isSupported();return !!m;},getFullScreen:function l(){return !!c('FullScreen').isFullScreen();},setFullScreen:function l(m){var n=true;if(m){c('AppInstallLogger').log(c('AppInstallLoggerEvents').RHC_SETTINGS_UNIT_APP_FULLSCREENED,j);n=c('FullScreen').enableFullScreen(document.getElementById('iframe_canvas'));}else n=c('FullScreen').disableFullScreen();return n;}};f.exports=k;}),null);
__d("XAppFriendsController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/platform\/games\/appfriends\/",{app_id:{type:"Int",required:true}});}),null);
__d('CanvasPresenceController',['Arbiter','AsyncRequest','AvailableListConstants','AvailableList','PresenceStatus','XAppFriendsController'],(function a(b,c,d,e,f,g){var h=60*1000,i=false,j=[],k=0,l,m,n,o;function p(){var u=0;j.forEach(function(v){if(c('PresenceStatus').get(v)==c('AvailableListConstants').ACTIVE)u++;});if(n===undefined||n!==u>1){n=u>1;c('Arbiter').inform('canvas.friendsOnlineUpdated',n);}}function q(u){var v=c('XAppFriendsController').getURIBuilder().setInt('app_id',k).getURI();new (c('AsyncRequest'))().setURI(v).setHandler(function(w){j=w.payload.ids;if(u)u();p();}).send();}function r(){if(k===0){o=r;return;}i=true;q(function(){l=setInterval(q,h);m=c('AvailableList').subscribe(c('AvailableListConstants').ON_AVAILABILITY_CHANGED,p);});}function s(){i=false;clearInterval(l);c('AvailableList').unsubscribe(m);}var t={setAppID:function u(v){k=v;if(o)o();},setAppFriends:function u(v){j=v;},useFriendsOnline:function u(v){if(v==i)return;if(v){r();}else s();}};f.exports=t;}),null);
__d("XPendingSyncRequestsController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/platform\/games\/sync_requests\/pending_list\/",{app_id:{type:"Int",required:true}});}),null);
__d('CanvasSyncRequestsController',['Arbiter','AsyncRequest','ChannelConstants','SyncRequestStatusEnum','XPendingSyncRequestsController'],(function a(b,c,d,e,f,g){var h={},i=false,j=0,k;function l(q){if(n(q))m(q);h[q.id]=q;q.timer=setTimeout(function(){q.status=c('SyncRequestStatusEnum').EXPIRED;o(q);},q.timeout*1000);}function m(q){clearTimeout(h[q.id].timer);delete h[q.id];}function n(q){return h[q.id]!==undefined;}function o(q){if(!n(q))return;if(q.status!=c('SyncRequestStatusEnum').PENDING){var r={id:q.id,status:c('SyncRequestStatusEnum').namesByValue[q.status]};c('Arbiter').inform('canvas.syncRequestUpdated',r);m(q);}}c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('sync_request_created'),function(q,r){return l(r.obj);});c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('sync_request_updated'),function(q,r){return o(r.obj);});var p={setAppID:function q(r){j=r;if(k)k();},initPendingSyncRequests:function q(){if(i)return;if(j===0){k=p.initPendingSyncRequests;return;}i=true;var r=c('XPendingSyncRequestsController').getURIBuilder().setInt('app_id',j).getURI();new (c('AsyncRequest'))().setURI(r).setHandler(function(s){s.getPayload().forEach(l);}).send();}};f.exports=p;}),null);
__d('JSONRPC',['Log'],(function a(b,c,d,e,f,g){function h(i){'use strict';this.$JSONRPC1=0;this.$JSONRPC2={};this.remote=function(j){this.$JSONRPC3=j;return this.remote;}.bind(this);this.local={};this.$JSONRPC4=i;}h.prototype.stub=function(i){'use strict';this.remote[i]=function(){var j={jsonrpc:'2.0',method:i};for(var k=arguments.length,l=Array(k),m=0;m<k;m++)l[m]=arguments[m];if(typeof l[l.length-1]=='function'){j.id=++this.$JSONRPC1;this.$JSONRPC2[j.id]=l.pop();}j.params=l;this.$JSONRPC4(JSON.stringify(j),this.$JSONRPC3||{method:i});}.bind(this);};h.prototype.read=function(i,j){'use strict';var k=JSON.parse(i),l=k.id;if(!k.method){if(!this.$JSONRPC2[l]){c('Log').warn('Could not find callback %s',l);return;}var m=this.$JSONRPC2[l];delete this.$JSONRPC2[l];delete k.id;delete k.jsonrpc;m(k);return;}var n=this,o=this.local[k.method],p;if(l){p=function s(t,u){var v={jsonrpc:'2.0',id:l};v[t]=u;setTimeout(function(){n.$JSONRPC4(JSON.stringify(v),j);},0);};}else p=function s(){};if(!o){c('Log').error('Method "%s" has not been defined',k.method);p('error',{code:-32601,message:'Method not found',data:k.method});return;}k.params.push(p.bind(null,'result'));k.params.push(p.bind(null,'error'));try{var r=o.apply(j||null,k.params);if(typeof r!=='undefined')p('result',r);}catch(q){c('Log').error('Invokation of RPC method %s resulted in the error: %s',k.method,q.message);p('error',{code:-32603,message:'Internal error',data:q.message});}};f.exports=h;}),null);
__d('PlatformAppController',['errorCode','Arbiter','AsyncRequest','Bootloader','CanvasNavigationFullScreen','CanvasPresenceController','CSS','CurrentUser','Dialog','JSONRPC','PlatformDialogClient','PlatformDialogWhitelistedParams','PlatformDialogABTest','Style','URI','Vector','XdArbiter','CanvasSyncRequestsController','ge'],(function a(b,c,d,e,f,g,h){var i={oauth:true,test_flow:true,app_requests:true,game_group_create:true,game_group_join:true,gift:true,feed:true,share:true,share_open_graph:true,sync_request:true,payer_promotion:true,payerpromotion:true},j,k,l=true,m=0,n=false,o,p=false,q=window._cstart,r=0,s,t,u={},v=new (c('JSONRPC'))(function(ia,ja){c('XdArbiter').send('FB_RPC:'+ia,ja.source||c('ge')(j).contentWindow.frames['fb_xdm_frame_'+location.protocol.replace(':','')],ja.origin||k);});c('Arbiter').subscribe("XdArbiter/register",function(ia,ja){if(s&&ja.origin!=k)new (c('AsyncRequest'))().setURI('/platform/app_owned_url_check/').setData({appid:s,url:ja.origin}).setHandler(function(ka){var la=ka.getPayload();if(la.allowed)k=ja.origin;}).send();});function w(ia){var ja=parseInt(ia.x,10),ka=parseInt(ia.y,10);if(ja>=0&&ka>=0)window.scrollTo(ja,ka);}function x(ia){var ja=c('ge')(ia.frame.replace(/_fb_https$/,''));if(ja){c('CSS').addClass(ja,'noresize');ja.style.height=ia.height+'px';}}function y(){var ia=c('ge')(j),ja=0,ka=0;while(ia){ja+=parseInt(ia.offsetLeft,10);ka+=parseInt(ia.offsetTop,10);ia=ia.offsetParent;}var la=c('Vector').getViewportDimensions(),ma=c('Vector').getScrollPosition();return {clientWidth:la.x,clientHeight:la.y,scrollLeft:ma.x,scrollTop:ma.y,offsetLeft:ja,offsetTop:ka};}function z(ia,ja){if(!c('PlatformDialogWhitelistedParams')[ja])return ia;var ka={};c('PlatformDialogWhitelistedParams').common.forEach(function(la){ka[la]=ia[la];});c('PlatformDialogWhitelistedParams')[ja].forEach(function(la){ka[la]=ia[la];});return ka;}function aa(ia,ja,ka){var la=ia.method;delete ia.method;delete ia.access_token;delete ia.next;delete ia.context;delete ia.locale;ia.display='async';if(!/^[\w\-_.]+$/.test(la))throw new Error('Malformed method name');Object.keys(ia).forEach(function(qa){if(/[\s\x80-\x9f]/.test(qa)){delete ia[qa];}else if(/\./.test(qa)){var ra=qa.replace(/\./g,'_');if(ia.hasOwnProperty(ra))delete ia[qa];}});if(!ia.redirect_uri||new (c('URI'))(ia.redirect_uri).getOrigin()!=new (c('URI'))(this.origin).getOrigin())ia.redirect_uri=this.origin;if(la=='apprequests'){la='app_requests';ia.context='canvas_app_requests';}if(la=='pay'){var ma=ia.action;if(ma==='purchaseitem'||ma==='purchase_item'||ma==='purchaseiap'){i[la]=true;}else i[la]=false;}if(la=='fbpromotion'){la='payer_promotion';ia.action='payer_promotion';}if(la==='stream_publish')la='stream.publish';if(la=='permissions.oauth'||la=='permissions.request'||la=='oauth')la='oauth';if(la==='stream.publish')i[la]=!!c('PlatformDialogABTest').share_dialog_delegate_stream_publish_dialog;ia=z(ia,la);if(i[la]){var na=ia.redirect_uri;c('PlatformDialogClient').async(la,ia,function(qa){if(qa.error_code==1340004){if(c('CurrentUser').getID()&&c('CurrentUser').getID()!="0"){ja(qa);}else new (c('URI'))('/login.php').addQueryData('next',c('URI').getRequestURI().toString()).go();}else if(la=='app_requests'&&qa.error_code==1349146){ba(la,ia,ja,qa,na);}else ja(qa);});return;}var oa=new (c('URI'))('/fbml/ajax/dialog/'+la.replace(/\./g,'_')).setQueryData(ia),pa=new (c('AsyncRequest'))().setMethod('GET').setReadOnly(true).setURI(oa).setAbortHandler(function(){ka(c('PlatformDialogClient').REQUEST_ABORTED_ERROR);});new (c('Dialog'))().setAsync(pa).setModal(true).setWideDialog(true).show().setCloseHandler(ja);}function ba(ia,ja,ka,la,ma){ja.redirect_uri=ma;c('PlatformDialogClient').async('oauth',ja,function(na){if(na.error){ka(la);}else{ja.redirect_uri=ma;c('PlatformDialogClient').async(ia,ja,function(oa){ka(oa);});}});}function ca(ia){n=ia;}function da(ia,ja){p=ia;o=ja;}v.stub('navigate');function ea(ia){if(n){v.remote.navigate(ia);return true;}return false;}v.stub('enterFullScreen');c('Arbiter').subscribe('canvas.enter_fullscreen',v.remote.enterFullScreen);v.stub('exitFullScreen');c('Arbiter').subscribe('canvas.exit_fullscreen',v.remote.exitFullScreen);v.stub('fireEvent');c('Arbiter').subscribe('canvas.friendsOnlineUpdated',v.remote.fireEvent.bind(v.remote));c('Arbiter').subscribe('canvas.syncRequestUpdated',v.remote.fireEvent.bind(v.remote));function fa(ia){var ja=ia.time-q+r;switch(ia.name){case 'StopIframeAppTtiTimer':r=ja;return {time_delta_ms:ja,type:"tti"};case 'StartIframeAppTtiTimer':q=ia.time;break;case 'RecordIframeAppTti':if(p)c('Bootloader').loadModules(["CanvasIFrameLogger"],function(ka){ka.log(ja,ia.appId,o);},'PlatformAppController');return {time_delta_ms:ja,type:"tti"};}}v.local.setSize=x;v.local.getPageInfo=y;v.local.scrollTo=w;v.local.showDialog=aa;v.local.setNavigationEnabled=ca;v.local.isFullScreenSupported=c('CanvasNavigationFullScreen').isSupported;v.local.getFullScreen=c('CanvasNavigationFullScreen').getFullScreen;v.local.logTtiMessage=fa;v.local.useFriendsOnline=c('CanvasPresenceController').useFriendsOnline.bind(c('CanvasPresenceController'));v.local.initPendingSyncRequests=c('CanvasSyncRequestsController').initPendingSyncRequests.bind(c('CanvasSyncRequestsController'));c('XdArbiter').setRpcHandler(function(ia){v.read.apply(v,ia);});v.stub('hidePluginObjects');c('Arbiter').subscribe('layer_shown',function(){if(++m===1)if(l){v.remote.hidePluginObjects();}else c('Style').set(c('ge')('pagelet_canvas_content'),'visibility','hidden');});v.stub('showPluginObjects');c('Arbiter').subscribe('layer_hidden',function(){if(--m===0){if(l){v.remote.showPluginObjects();}else c('Style').set(c('ge')('pagelet_canvas_content'),'visibility','');}else if(m<0)m=0;});function ga(ia){u[ia.name]=ia;var ja=c('ge')(ia.name);if(ja)j=ja;}var ha={setActiveIframeAndAppID:function ia(ja,ka,la){j=ja;k=ka;s=la;c('CanvasPresenceController').setAppID(s);c('CanvasSyncRequestsController').setAppID(s);},setInformAppOnLayerChange:function ia(ja){l=ja;},setNavigationEnabled:ca,setTtiEnabled:da,handleNavigation:ea,init:ga,getFrameParams:function ia(ja){return u[ja];},setConfig:function ia(ja){t=ja;}};b.PlatformAppController=ha;f.exports=ha;}),null);
__d('FavIcon',['DOM'],(function a(b,c,d,e,f,g){var h,i,j;function k(){var m=c('DOM').scry(document.head,"link");if(m)m.forEach(function(n){if(n.rel.indexOf('icon')!=-1||n.rel.indexOf('shortcut icon')!=-1)c('DOM').remove(n);});}var l={isToggledResource:function m(){if(j&&h.href===j)return true;return false;},set:function m(n){if(h)c('DOM').remove(h);k();h=c('DOM').create('link',{type:'image/x-icon',rel:'icon',href:n});c('DOM').appendContent(c('DOM').find(document,'head'),h);},setToggleResources:function m(n,o){h=document.querySelector('link[rel*=icon][href*=".ico"]');if(!h)return;i=o||h.href;j=n;},toggle:function m(){if(!h||!j)return;if(h.href===i){this.set(j);return;}this.set(i);}};f.exports=l;}),null);
__d('PlatformCanvasController',['fbt','PlatformAppController','DOMEventListener','URI','CSS','DOM','DocumentTitle','FavIcon','ge','AsyncRequest','UserActivity','UIPagelet','PageTransitions'],(function a(b,c,d,e,f,g,h){var i='iframe_canvas',j=240000,k=5000,l=60000,m,n,o,p,q,r,s;function t(ca){var da=c('ge')('pagelet_canvas_content');c('CSS').hide(da);c('DOM').scry(da,'iframe').forEach(function(ea){ea.src='';});c('DOM').setContent(c('ge')('canvas_throbber_text'),h._("Loading {app-name}",[h.param('app-name',ca)]));}function u(ca,da,ea,fa){var ga=c('ge')('pagelet_canvas_footer_content'),ha=c('ge')('pagelet_canvas_content');c('DOM').setContent(ha,ca);c('DOM').setContent(ga,da);c('CSS').show(ha);c('DocumentTitle').set(ea);c('FavIcon').set(fa);}function v(ca){if(ca.getSubdomain()!='apps')return false;var da,ea=c('DOM').scry(document,'a[data-appname]');for(var fa=0;fa<ea.length;fa++)if(ea[fa].href==ca){da=ea[fa].getAttribute('data-appname');break;}if(!da)return false;var ga=ca.getPath().split('/')[1];if(ga=='l.php')return false;t(da);var ha=ca.getUnqualifiedURI();new (c('AsyncRequest'))().setURI(new (c('URI'))('/ajax/canvas.php')).setData({fb_app_name:ga,uri:ha.toString()}).setMethod('GET').setReadOnly(true).setStatusElement('canvas_throbber').setHandler(function(ia){var ja=ia.getPayload();c('CSS').conditionClass(document.body,'center_fixed_width_app',!ja.is_liquid);u(ja.main_html,ja.footer_html,ja.page_title,ja.favicon);c('PageTransitions').transitionComplete();}).send();return true;}function w(ca){if(!String(ca.getPath()).startsWith('/'+o+'/')&&!String(ca.getPath()).startsWith('/'+n+'/'))return false;ca=ca.getUnqualifiedURI();ca.setPath('/'+ca.getPath().split('/').slice(2).join('/'));return c('PlatformAppController').handleNavigation(ca.toString());}function x(ca){return w(ca)||v(ca);}function y(){var ca=Date.now();if(m>0&&ca-p>=j){p=ca;c('UIPagelet').loadFromEndpoint('WebEgoPane','pagelet_ego_pane',{pid:9,data:[n,++q]},{bundle:false});}}c('UserActivity').subscribe(function(){var ca=Date.now();if(ca-p>=j-k)setTimeout(y,k);});function z(){var ca=Date.now();if(m>0&&ca-r>=l){r=ca;c('UIPagelet').loadFromEndpoint('CanvasShowcaseSliderPagelet','pagelet_canvas_showcase',{pid:129,data:[n,++s]},{bundle:false});}}function aa(ca,da,ea,fa,ga){m=ea;p=Date.now();q=0;r=Date.now();s=0;if(n&&n!==ca)y();n=ca;o=da;var ha=c('ge')(i);c('PlatformAppController').setConfig(ga);if(ha)c('DOMEventListener').add(ha,'load',function(){c('PlatformAppController').setNavigationEnabled(false);});if(ga&&ga.displayShowcase)setInterval(z,l);c('PlatformAppController').setInformAppOnLayerChange(!fa);c('PlatformAppController').setNavigationEnabled(false);c('PageTransitions').registerHandler(x);}var ba={setup:aa};f.exports=ba;}),null);
__d('SearchBootstrapCache',['AsyncRequest','AsyncResponse','CacheStorage','SearchBootstrapCacheConstants'],(function a(b,c,d,e,f,g){var h=1,i={get:function j(k,l,m,n,o){var p=this.getKey(k,l,m),q=this.getStorage(),r=q.get(p),s=c('SearchBootstrapCacheConstants')[l.type]||3600000;if(r==null||Date.now()-r.timestamp>s){o(m,k,l);}else{var t=new (c('AsyncRequest'))();t.getData=function(){return r.requestData;};var u=new (c('AsyncResponse'))(t,r.payload);n(u,l);}},set:function j(k,l,m){var n=k.getRequest().getData();this.getStorage().set(this.getKey(n,l,m),{timestamp:Date.now(),payload:k.payload,requestData:n});},getKey:function j(k,l,m){return JSON.stringify({filter:k.filter,context:k.context,viewer:k.viewer,lazy:k.lazy,token:k.token,type:l.type,bootstrapEndpoint:m});},getStorage:function j(){return new (c('CacheStorage'))('localstorage','_SearchBootstrapCache_'+h);}};f.exports=i;}),null);
__d('SearchSingleState',['fbt'],(function a(b,c,d,e,f,g,h){function i(k,l,m,n){return {classNames:'grammar',groupIndex:0,indexInGroup:k,path:l,text:m,type:'grammar',uid:n};}var j={getSuggestions:function k(l,m,n){if(n==='ent:user'){return this.getSuggestionsForUser(l,m);}else if(n==='ent:page'){return this.getSuggestionsForPage(l,m);}else if(n==='ent:app'){return this.getSuggestionsForApp(l,m);}else if(n==='ent:group')return this.getSuggestionsForGroup(l,m);},getSuggestionsForUser:function k(l,m){return [i(0,'/search/'+l+'/photos-of',h._("photos of {full name}",[h.param('full name',m)]),'photos_of_user'),i(1,'/search/'+l+'/friends',h._("friends of {full name}",[h.param('full name',m)]),'friends_of_user'),i(2,'/search/'+l+'/pages-liked',h._("favorite pages of {full name}",[h.param('full name',m)]),'pages_liked_user'),i(3,'/search/str/'+m+'/users-named',h._("find all people named \"{full name}\"",[h.param('full name',m)]),'people_named_text')];},getSuggestionsForPage:function k(l,m){return [i(0,'/search/'+l+'/photos-of',h._("photos of {name of page}",[h.param('name of page',m)]),'photos_of_page'),i(1,'/search/'+l+'/likers',h._("people who like {name of page}",[h.param('name of page',m)]),'page_likers'),i(2,'/search/str/'+m+'/pages-named',h._("find all pages named \"{name of page}\"",[h.param('name of page',m)]),'pages_named_text')];},getSuggestionsForGroup:function k(l,m){return [i(0,'/search/'+l+'/members',h._("{name of group} members",[h.param('name of group',m)]),'members_of_group'),i(1,'/search/'+l+'/photos-in',h._("photos in {name of groups}",[h.param('name of groups',m)]),'photos_in_group'),i(2,'/search/'+l+'/creators',h._("{name of group} creators",[h.param('name of group',m)]),'creators_of_group'),i(3,'/search/'+l+'/admins',h._("{name of group} administrators",[h.param('name of group',m)]),'admins_of_group')];},getSuggestionsForApp:function k(l,m){return [i(0,'/search/'+l+'/apps-similar-to',h._("apps similar to {name of app}",[h.param('name of app',m)]),'similar_apps'),i(1,'/search/'+l+'/app-users',h._("people who use {name of app}",[h.param('name of app',m)]),'app_users'),i(2,'/search/str/'+m+'/pages-named',h._("find all apps named \"{name of page}\"",[h.param('name of page',m)]),'apps_named_text')];}};f.exports=j;}),null);
__d('SearchDataSource',['errorCode','Arbiter','AsyncResponse','CSRFGuard','CurrentUserInitialData','DataSource','Event','FacebarJSConstants','HashtagSearchResultUtils','Map','PageTransitionsRegistrar','SearchBootstrapCache','SearchRegion','SearchSingleState','UnicodeCJK','XHRRequest','createArrayFromMixed','debounce'],(function a(b,c,d,e,f,g,h){var i,j,k=100,l='/typeahead/search/facebar/nullstate/';i=babelHelpers.inherits(m,c('DataSource'));j=i&&i.prototype;function m(n){'use strict';n.headerflags=new (c('Map'))();if(c('SearchRegion').sgp_fork_ss_at_proxygen||c('SearchRegion').sgp_fork_gs_at_proxygen)n.headerflags.set('X-FB-ForkingType','edge-sgp-search');j.constructor.call(this,n);this._token=n.token||'';this._lazyonload=n.lazyonload===false?false:true;this._extraTypes=n.extraTypes;this._buckets=n.buckets;this._noMultiFetch=n.noMultiFetch||false;this._nullStateConfig=n.nullStateConfig||{};var o=n.maxResults||8;this._numResults={min:3,max:o};this.recordingRoute=n.recordingRoute||'non_banzai';this._enabledHashtag=n.enabledHashtag||false;this.logBackendQueriesWindow=n.logBackendQueriesWindow||25;this._genTime=n.genTime;this._bootstrapError=false;this._hasKeywordBootstrap=n.hasKeywordBootstrap||false;this._addJoinedTermsMatching=n.addJoinedTermsMatching||false;this._useBootstrapCache=n.useBootstrapCache||false;this._useBrowserCache=n.useBrowserCache||false;this.cacheUnicodeMatch.setConfigs({prefix_hangul_conjoining_jamo:true,prefix_kana_drop_trailing_latin:n.cjkDropLatinInCjTokens,prefix_kana_hiragana_to_katakana:n.cjkUiCacheHiraganaToKatakana,search_i18n_prefix_arabic_normalization:n.arabicNormalization});this.backendUnicodeMatch.setConfigs({prefix_kana_drop_trailing_latin:n.cjkDropLatinInCjTokens});}m.prototype.init=function(){'use strict';j.init.call(this);this._leanPayload=null;this._bootstrapRequestsPending=0;this._criticalOnly=true;this._updateMaxResults();var n=c('debounce')(this._updateMaxResults,k,this,true);c('Event').listen(window,'resize',n);if(this._nullStateConfig.prefetchNullState)this.fetchNullState('');if(this._nullStateConfig.singleState)c('Arbiter').subscribe('page_transition',this.handlePageTransition.bind(this));if(this._nullStateConfig.prefetchNullState||this._nullStateConfig.singleState)c('Arbiter').subscribe('search/updateNullState',this.updateNullState.bind(this));if(this._nullStateConfig.recent)c('Arbiter').subscribe('search/refreshRecentSearchesNullstate',this.refreshRecentSearches.bind(this));};m.prototype.refreshRecentSearches=function(){'use strict';this.nullStateData=null;};m.prototype.handlePageTransition=function(){'use strict';this.nullStateParams={};};m.prototype.updateNullState=function(event,n){'use strict';this.nullStateParams=n;this.fetchNullState();};m.prototype.markResultsAsNullState=function(n){'use strict';if(n)for(var o=n,p=Array.isArray(o),q=0,o=p?o:o[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var r;if(p){if(q>=o.length)break;r=o[q++];}else{q=o.next();if(q.done)break;r=q.value;}var s=r;s.isNullState=true;}};m.prototype.markResultsAsSingleState=function(n){'use strict';if(n)for(var o=n,p=Array.isArray(o),q=0,o=p?o:o[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var r;if(p){if(q>=o.length)break;r=o[q++];}else{q=o.next();if(q.done)break;r=q.value;}var s=r;s.isSingleState=true;}};m.prototype.fetchNullState=function(n){'use strict';this.lastNullOrSingleStateFetchStartTime=Date.now();if(!this._nullStateConfig.hasNullState)return;var o=null;if(this.nullStateParams&&this.nullStateParams.uid){this.nullStateParams.query=n||'';o=this._fetchDataForSingleState();this.markResultsAsNullState(o);}else{o=this._fetchDataForNullState();this.markResultsAsSingleState(o);}if(o)this.inform('respond',{value:this.nullStateParams?this.nullStateParams.query:'',results:o,isAsync:false,nullState:true});};m.prototype._fetchDataForSingleState=function(){'use strict';if(this.nullStateDataWithProfile&&this.nullStateParams.uid===this.nullStateDataWithProfile.profileID)return this.nullStateDataWithProfile.data;if(this.nullStateParams.type==='ent:app'||this.nullStateParams.type==='ent:group'||this.nullStateParams.type==='ent:page'){this.fetch(l,{profile_id:this.nullStateParams.uid,ent_type:this.nullStateParams.type},{singleState:true});this.nullStateDataWithProfile={profileID:this.nullStateParams.uid};return;}var n=c('SearchSingleState').getSuggestions(this.nullStateParams.uid,this.nullStateParams.text,this.nullStateParams.type);if(!n)return this._fetchDataForNullState();this.nullStateDataWithProfile={data:n,profileID:this.nullStateParams.uid};return n;};m.prototype._shouldRefreshNullState=function(){'use strict';if(!this._nullStateConfig.recent)return false;var n=window.location.href;if(!n)return false;if(n.contains('allactivity')&&n.contains('log_filter=search'))return true;return false;};m.prototype._fetchDataForNullState=function(){'use strict';if(this.nullStateData&&!this._shouldRefreshNullState()){this.markResultsAsNullState(this.nullStateData);setTimeout(function(){this.inform('respond',{value:'',results:this.nullStateData,isAsync:true,nullState:true});}.bind(this),0);return;}if(!this.fetchingNullState){this.fetchingNullState=true;this.fetch(l,{value:""},{nullState:true,value:''});}return null;};m.prototype.dirty=function(){'use strict';j.dirty.call(this);this._bootstrapError=false;this._fetchOnUseRequests=[];};m.prototype.asyncErrorHandler=function(n,o){'use strict';if(o.nullState)this.fetchingNullState=false;if(o.bootstrap)this._bootstrapError=true;this.inform('fetchError',{response:n,fetch_context:o});};m.prototype.fetch=function(n,o,p){'use strict';p=p||{};p.fetch_start=Date.now();var q=c('PageTransitionsRegistrar').getMostRecentURI().path;o=babelHelpers['extends']({},o,{path:q});j.fetch.call(this,n,o,p);};m.prototype.xhrFetchHandler=function(n,o,p){'use strict';n=c('CSRFGuard').clean(n);var q=JSON.parse(n);return this.fetchHandler(new (c('AsyncResponse'))(null,q.payload),p,o);};m.prototype.fetchHandler=function(n,o){var p=arguments.length<=2||arguments[2]===undefined?null:arguments[2];'use strict';if(o.nullState){this.fetchingNullState=false;this.nullStateData=n.getPayload().entries;this.markResultsAsNullState(this.nullStateData);this.inform('respond',{value:'',results:this.nullStateData,isAsync:true,nullState:true});return;}if(o.singleState){this.nullStateDataWithProfile.data=n.getPayload().entries;this.markResultsAsSingleState(this.nullStateDataWithProfile.data);this.inform('respond',{results:this.nullStateDataWithProfile.data,isAsync:true,value:this.nullStateParams?this.nullStateParams.query:'',nullState:true});return;}var q=n.getPayload(),r=babelHelpers['extends']({fetch_end:Date.now()},o),s=r.value?c('Arbiter').BEHAVIOR_EVENT:c('Arbiter').BEHAVIOR_PERSISTENT;this.inform('beginFetchHandler',{response:n});if(o.bootstrap)this._bootstrapError=false;var t=p===null?n.getRequest().uri.getPath():p.getURI().getPath();if(t===this.bootstrapEndpoint&&this._useBootstrapCache)c('SearchBootstrapCache').set(n,o,this.bootstrapEndpoint);if(o.type=='lean'){this._leanPayload=q;this._processLean();}else{if(q.coeff2_ts)r.coeff2_ts=q.coeff2_ts;j.fetchHandler.call(this,n,o);var u=p===null?n.getRequest().getData():p.getData();if(o.bootstrap&&!u.no_cache)r.browserCacheHit=q.timestamp<this._genTime;if(o.bootstrap&&!q.no_data&&this._bootstrapRequestsPending>0){o.bootstrap=false;--this._bootstrapRequestsPending;!this._bootstrapRequestsPending&&this._bootstrapPostProcess();}if(q.no_data||q.stale||q.token!==this._token){var v=babelHelpers['extends']({},u);if(v.lazy){delete v.lazy;v.token=this._token;this._fetchOnUse(v,o);}}}this.inform('endpointStats',{info:r,response:n},s);if(o&&!!o.value)this.inform('completeFetch',{response:n,stats:r});var w=this.getResponseHeaderValue('X-FB-ForkingPoolID');if(w.length>0)this.inform('logProxygenForkPoolId',{field:'fork_pool_id',value:w});};m.prototype.respond=function(n,o,p){'use strict';this.inform('respondValidUids',o);this.inform('reorderResults',o);var q=this.buildData(o,n);q.forEach(function(r,s){r.origIndex=s;r.fromCache=!p;});this.inform('respond',{value:n,results:q,isAsync:!!p});return q;};m.prototype.buildData=function(n,o){'use strict';if(!n||n.length===0)return [];var p=n.map(this.getEntry,this);p.length=Math.min(p.length,this._maxResults);return p;};m.prototype.fetchLean=function(){'use strict';this._fetchLean();};m.prototype._isQueryTooShort=function(n){'use strict';return n.length<this._minQueryLength&&!this._performShortQuery&&!c('UnicodeCJK').hasIdeoOrSyll(n);};m.prototype.shouldFetchMoreResults=function(n){'use strict';return n.length<this._maxResults;};m.prototype._bootstrapPostProcess=function(){'use strict';var n=0;for(var o in this._data)if(this._data.hasOwnProperty(o))n++;this.inform('bootstrapped',{time:Date.now(),size:n},c('Arbiter').BEHAVIOR_PERSISTENT);this._processLean();};m.prototype._processLean=function(){'use strict';if(this._leanPayload){var n,o=this._leanPayload.entries;for(var p in o){n=this.getEntry(p);if(n)n.index=o[p];}this.setExclusions(this._leanPayload.blocked);this._leanPayload=null;}};m.prototype._updateMaxResults=function(){'use strict';var n=window.innerHeight||document.documentElement.clientHeight;this.setMaxResults(Math.max(this._numResults.min,Math.min(this._numResults.max,Math.ceil(2+(n-370)/56))));};m.prototype._bootstrapFetch=function(n,o){'use strict';var p=babelHelpers['extends']({},o,this.bootstrapData);if(this._criticalOnly&&this._lazyonload)p.lazy=1;var q={bootstrap:true,type:n};this._fetchBootstrapMaybeCache(p,q);++this._bootstrapRequestsPending;};m.prototype._fetchBootstrapMaybeCache=function(n,o){var p,q=this;'use strict';if(this._useBootstrapCache){c('SearchBootstrapCache').get(n,o,this.bootstrapEndpoint,this.fetchHandler.bind(this),this.fetch.bind(this));}else if(this._useBrowserCache){(function(){var r=new (c('XHRRequest'))(q.bootstrapEndpoint).setData(babelHelpers['extends']({},n,{__user:c('CurrentUserInitialData').USER_ID,__a:1})).setMethod('GET').setResponseHandler(function(s){return this.xhrFetchHandler(s,r,o||{});}.bind(q)).setErrorHandler(function(s){return this.asyncErrorHandler(s,o);}.bind(q));q.inform('beforeFetch',{request:r,fetch_context:o});r.send();})();}else this.fetch(this.bootstrapEndpoint,n,o);};m.prototype._fetchOnUse=function(n,o){'use strict';for(var p in this.bootstrapData)!n.hasOwnProperty(p)&&(n[p]=this.bootstrapData[p]);if(this._criticalOnly){this._fetchOnUseRequests.push({args:n,ctx:o});}else this._fetchBootstrapMaybeCache(n,o);};m.prototype._fetchLean=function(){'use strict';var n={no_cache:1};n.options=c('createArrayFromMixed')(n.options);n.options.push('lean');this._fetchOnUse(n,{type:'lean'});};m.prototype.bootstrap=function(n){'use strict';if(!n){this._criticalOnly=false;this._flushFetchOnUseRequests();}if(this._bootstrapped)return;var o={filter:['event']};this._fetchOnUse(o,{type:'event'});var p=['app','page','group','friendlist'];p=p.concat(this._extraTypes||[]);var q=[];if(this._hasKeywordBootstrap)q.push(c('FacebarJSConstants').keywordType);if(this._noMultiFetch){p.push('user');p=p.concat(q);this._bootstrapFetch('user',{filter:p});}else{this._bootstrapFetch('other',{filter:p});if(this._buckets){for(var r=0;r<this._buckets.length;++r){var s={filter:['user'],buckets:this._buckets[r]};this._bootstrapFetch('user',s);}}else this._bootstrapFetch('user',{filter:['user']});if(q.length>0)this._bootstrapFetch('keyword',{filter:q});}this._fetchLean();this._bootstrapped=true;};m.prototype.getBootstrapError=function(){'use strict';return this._bootstrapError;};m.prototype._flushFetchOnUseRequests=function(){'use strict';var n=this._fetchOnUseRequests.length;for(var o=0;o<n;++o){var p=this._fetchOnUseRequests[o];this._fetchBootstrapMaybeCache(p.args,p.ctx);}if(n>0)this.inform('extra_bootstrap',{time:Date.now()},c('Arbiter').BEHAVIOR_PERSISTENT);this._fetchOnUseRequests=[];};m.prototype.onLoad=function(n,o){'use strict';this.inform('onload',{time:Date.now()},c('Arbiter').BEHAVIOR_PERSISTENT);if(n)setTimeout(this.bootstrap.bind(this,o),0);};m.prototype.mergeUids=function(n,o,p,q){'use strict';var r=this.getDynamicHashtagResult(q);if(q&&r&&o.indexOf(r)<=0)o.unshift(r);var s=p[0]?this.getEntry(p[0]):null,t=o[0]?this.getEntry(o[0]):null,u=s&&s.replace_results?s:null;u=!u&&t&&t.replace_results?t:u;var v=j.mergeUids.call(this,n,o,p,q);if(u){this.inform('backend_topreplace',{});return this.deduplicateByKey([u.uid].concat(v));}return v;};m.prototype.getTextToIndexFromFields=function(n,o){'use strict';var p=[],q=n.tokenVersion==="v2";for(var r=0;r<o.length;++r){if(q&&(o[r]==="text"||o[r]==="alias"))continue;var s=n[o[r]];if(s){s=s.join?s.join(' '):s;p.push(s);if(o[r]=='text'&&this._addJoinedTermsMatching){s=s.toLowerCase();s=s.replace(/ /g,'');p.push(s);}}}return p.join(' ');};m.prototype.getDynamicHashtagResult=function(n){'use strict';if(!n||!this._enabledHashtag)return;var o=c('HashtagSearchResultUtils').getHashtagFromQuery(n);if(!o)return;var p='hashtag:'+o,q=this.getEntry(p);if(!q)this.processEntries([c('HashtagSearchResultUtils').makeTypeaheadResult(o)],n);return p;};m.prototype.tokenizeCache=function(n,o){'use strict';n=this.cacheUnicodeMatch.prefixMatchPrepare(n);var p=this._tokenize(n,o),q=p.tokens;if(q.length>0&&p.value.startsWith('@'))q[0]='@'+q[0];return p;};f.exports=m;}),null);
__d('SearchTypeaheadRecorder',['AsyncRequest','Banzai','BanzaiNectar','BanzaiScuba','CurrentUser','Event','FacebarGlobalOptions','Keys','TokenizeUtil','Vector','clickRefAction','mapObject','ge','throttle','whitelistObjectKeys'],(function a(b,c,d,e,f,g){var h={WAITING:'WAITING',SUCCESS:'SUCCESS',NO_RESULTS:'NO_RESULTS',ERROR:'ERROR'};function i(k){'use strict';this.init(k);this.initEvents(k);}i.prototype.init=function(k){'use strict';this.core=k.getCore();this.data=k.getData();this.view=k.getView();this.element=this.core.getElement();this.initTime=Date.now();this._onloadTime=0;this._extraRecorder=[];this.performanceTimings={};this.allFromSingleState=false;this.allFromNullState=false;this._timeBetweenSelectAndLastRender=0;var l=c('ge')('search_first_focus');this.initStartTime=l&&l.value;this.bootstrapStats={bootstrapped:0};this.type="legacy_search";this._reset();};i.prototype._reset=function(){'use strict';this.stats={};this.avgStats={};this.appendStats={};this._backspacing=false;this.backendQueries=[];this.backendQueriesStatus={};this._topreplace=false;this._inflightRequests={};var k=Math.random().toString();this.data.setQueryData({sid:k});this.view.setSid(k);this.recordStat('sid',k);this.recordStat('keypressed',0);};i.prototype.initEvents=function(){'use strict';this.core.subscribe('focus',function(event){if(!this.stats.session_start_time){this.recordStat('session_start_time',Date.now());var k=new Date(),l=k.getTimezoneOffset(),m=Date.now()-l*60*1000;this.recordStat('session_start_time_user_timezone',m);this._lastRenderTime=0;}}.bind(this));this.core.subscribe('blur',function(event){var k=Date.now();for(var l in this._inflightRequests){var m=this._inflightRequests[l],n=k-m;this.recordAvgStat('search_endpoint_ms_from_js',n);}this.recordStat('session_end_time',k);this.submit();}.bind(this));this.view.subscribe('select',function(k,l){this.recordStat('time_between_select_and_last_render',Date.now()-this._lastRenderTime);this.recordSelectInfo(l);}.bind(this));this.view.subscribe('render',function(k,l){this._lastRenderTime=Date.now();this.recordRender(l);}.bind(this));this.data.subscribe('logPerformanceTiming',function(k,l){this.performanceTimings[l.field]=l.value;}.bind(this));this.data.subscribe('logProxygenForkPoolId',function(k,l){this.recordStat(l.field,l.value);}.bind(this));this.data.subscribe('activity',function(k,l){this.recordStat('pending_request',l.activity);}.bind(this));this.data.subscribe('respondValidUids',function(k,l){this.validUids=l.slice(0);}.bind(this));this.data.subscribe('beforeQuery',function(k,l){if(!l.value){this.query='';this.results=[];this.data.lastNullOrSingleStateFetchStartTime=Date.now();return;}if(!this.stats.first_query_time)this.recordStat('first_query_time',Date.now());this.query=l.value;if(!this.queryStartTime)this.queryStartTime=[];this.queryStartTime[this.query]=Date.now();this.recordCountStat('num_queries');}.bind(this));this.data.subscribe('queryEndpoint',function(k,l){this.recordCountStat('num_search_ajax_requests');this.recordAvgStat('endpoint_query_length',l.value.length);this._inflightRequests[l.value]=Date.now();}.bind(this));this.data.subscribe('onload',function(k,l){this._onloadTime=l.time;}.bind(this));this.data.subscribe('bootstrapped',function(k,l){this.bootstrapStats.endTime=l.time;this.bootstrapStats.bootstrapped=1;}.bind(this));this.core.subscribe('recordFunction',function(k,l){this._extraRecorder.push(l);}.bind(this));this.data.subscribe('endpointStats',function(k,l){var m=l.info,n=m.fetch_end-m.fetch_start;if(m.value){this.recordAvgStat('search_endpoint_ms_from_js',n);}else this.bootstrapStats[m.type]=n;if(m.coeff2_ts)this.bootstrapStats.coeff2_ts=m.coeff2_ts;if(typeof m.browserCacheHit!='undefined')this.recordCountStat(m.browserCacheHit?'bootstrap_cachehits':'bootstrap_cachemisses');if(this._inflightRequests[m.value])delete this._inflightRequests[m.value];}.bind(this));this.data.subscribe('fetchComplete',function(k,l){var m=l.entries,n=l.value;if(n&&this.backendQueriesStatus[n]){this._addDurationForBackendQuery(this.backendQueriesStatus[n]);this.backendQueriesStatus[n].status=m&&m.length>0?h.SUCCESS:h.NO_RESULTS;}}.bind(this));this.data.subscribe('fetchError',function(k,l){var m=l.fetch_context,n=m.value;if(m.bootstrap||!n)return;if(this.backendQueriesStatus[n]){this.backendQueriesStatus[n].status=h.ERROR;this._addDurationForBackendQuery(this.backendQueriesStatus[n]);}}.bind(this));this.data.subscribe('query',function(k,l){this.recordAvgStat('num_results_from_cache',l.results.length);}.bind(this));this.data.subscribe('backend_topreplace',function(k,l){if(false===this._topreplace){this.recordStat("backend_topreplace",1);this._topreplace=true;}}.bind(this));this.data.subscribe('completeFetch',function(k,l){if(this.core.scubaInfo){var m=l.response,n={recv:l.stats.fetch_end-l.stats.fetch_start,render:Date.now()-l.stats.fetch_start,payload_size:JSON.stringify(m).length};if(!m.payload.entities)m.payload.entities=this.buildResults();this.logToScuba(m,n,this.core.scubaInfo,this.query,this.type);}}.bind(this));this.data.subscribe('completeCacheFetch',c('throttle')(function(k,l){if(this.core.scubaInfo)this.logToScuba({},{},this.core.scubaInfo,this.query,this.type);}.bind(this),500));c('Event').listen(this.element,'keydown',function(event){this.recordStat('keypressed',1);this.recordCountStat('count_keys_pressed');if(c('Event').getKeyCode(event)==c('Keys').BACKSPACE){if(!this._backspacing&&this.query){this._backspacing=true;this.recordAppendStat('before_backspace_queries',this.query);}}else this._backspacing=false;}.bind(this));this.data.subscribe('beforeFetch',function(k,l){var m=l.request.data?l.request.data.value:null;if(!m)return;this.backendQueries.push(m);this.backendQueriesStatus[m]={status:h.WAITING,start_time:Date.now()};}.bind(this));};i.prototype.recordStat=function(k,l){'use strict';this.stats[k]=l;};i.prototype.recordCountStat=function(k){'use strict';var l=this.stats[k];this.stats[k]=l?l+1:1;};i.prototype.recordAvgStat=function(k,l){'use strict';if(this.avgStats[k]){this.avgStats[k][0]+=l;++this.avgStats[k][1];}else this.avgStats[k]=[l,1];};i.prototype.recordAppendStat=function(k,l){'use strict';if(!this.appendStats.hasOwnProperty(k))this.appendStats[k]=[];this.appendStats[k].push(l);};i.prototype.recordRender=function(k){'use strict';this.results=k.filter(function(v){return v.uid!='search'&&v.type!='disabled_result'&&v.type!='header';}).map(function(v){return babelHelpers['extends']({},v);});var l=null;if(this.queryStartTime)l=this.queryStartTime[this.query];var m=this.results.every(function(v){return v.fromCache||v.isSeeMore;}),n=this.results.every(function(v){return v.isFromGSEF||v.fromCache||v.isSeeMore||v.isJSBootstrapMatch;})&&this.results.some(function(v){return v.isFromGSEF;}),o=this.results.every(function(v){return v.isGloballyCachedKeyword||v.fromCache||v.isSeeMore||v.isJSBootstrapMatch;})&&this.results.some(function(v){return v.isGloballyCachedKeyword;}),p=this.results.every(function(v){return v.isNullState;}),q=this.results.every(function(v){return v.isSingleState;}),r=this.results.every(function(v){return v.exactMatchKeyword||v.isSeeMore;});this.allFromSingleState=q;this.allFromNullState=p;if(this.results.length&&this.data.lastNullOrSingleStateFetchStartTime&&p){this.recordStat('time_render_null_state',Date.now()-this.data.lastNullOrSingleStateFetchStartTime);this.data.lastNullOrSingleStateFetchStartTime=null;}else if(this.data.lastNullOrSingleStateFetchStartTime&&this.results.length&&q){this.recordStat('time_render_single_state',Date.now()-this.data.lastNullOrSingleStateFetchStartTime);}else if(l){var s=Date.now()-l;if(r){this.recordAppendStat('times_render_gs_echo',s);}else this.recordAppendStat(m?'times_render_local':'times_render_remote',s);if(!m&&n)this.recordAppendStat('time_render_gs_early_fetch',s);if(!m&&o)this.recordAppendStat('time_render_globally_cached_keywords',s);if(!m&&!n&&!o)this.recordAppendStat('time_render_remote_main_call',s);}this.data.lastNullOrSingleStateFetchStartTime=null;var t=c('Vector').getViewportDimensions();this.recordStat('window_size_width',t.x);this.recordStat('window_size_height',t.y);if(this.results.length>0&&!this.stats.first_result_time)this.recordStat('first_result_time',Date.now());var u='typed';if(this.allFromNullState){u='nullstate';}else if(this.allFromSingleState)u='singlestate';this.recordStat('last_state',u);};i.prototype.recordSelectInfo=function(k){'use strict';var l=k.selected,m=k.index;if(l.groupIndex!==undefined)m=k.index-l.groupIndex-1;var n={href:l.path},o=l.dataGT?{gt:JSON.parse(l.dataGT)}:{};c('clickRefAction')('click',n,null,null,o);if(l.uid=='search'||l.uid=='people_search'){this.recordStat('selected_search',1);}else if(l.uid=='invite'){this.recordStat('selected_invite',1);}else{var p=l.log_type||l.rankType||l.render_type||l.type,q=p=='friend'?'user':p;this.recordStat('selected_'+q,1);this.recordStat('selected_position',m);this.recordStat('selected_type',p);this.recordStat('selected_name_length',l.text.length);this.recordStat('selected_id',l.uid);this.recordStat('selected_degree',l.bootstrapped?1:2);this.recordStat('selected_recent_search',l.recent_search);var r=c('TokenizeUtil').parse(this.data.getTextToIndex(l)).tokens,s=j(r,this.query);if(s)this.recordStat('matched_terms',s);}var t={};this._extraRecorder.forEach(function(u){u(k,this.results,t);}.bind(this));this.recordStat('extra_select_info',JSON.stringify(t));this.recordStat('selected_with_mouse',k.clicked?1:0);};i.prototype._addDurationForBackendQuery=function(k){'use strict';if(k.start_time){k.duration=Date.now()-k.start_time;delete k.start_time;}};i.prototype._dataToSubmit=function(){'use strict';this.recordStat('candidate_results',this.buildResults());this.recordStat('query',this.query);this.recordStat('init_time',this.initTime);if(this.initStartTime){this.recordStat('init_start_time',this.initStartTime);this.recordStat('onload_time',this._onloadTime);this.initStartTime=0;}this.recordStat('bootstrapped',this.bootstrapStats.bootstrapped);if(this.bootstrapStats.endTime){this.recordStat('bootstrapped_time',this.bootstrapStats.endTime);this.recordStat('user_bootstrap_ms',this.bootstrapStats.user);this.recordStat('other_bootstrap_ms',this.bootstrapStats.other);this.bootstrapStats.endTime=0;}var k=this.data.getBootstrapError();if(k)this.recordStat('bootstrap_error',1);this.recordStat('coeff2_ts',this.bootstrapStats.coeff2_ts);this.recordStat('max_results',this.data._maxResults);if(this.backendQueries.length>0){if(this.backendQueries.length>this.data.logBackendQueriesWindow)this.backendQueries=this.backendQueries.slice(this.backendQueries.length-this.data.logBackendQueriesWindow);this.recordStat('backend_queries',this.backendQueries);var l=c('whitelistObjectKeys')(this.backendQueriesStatus,this.backendQueries);c('mapObject')(l,this._addDurationForBackendQuery,this);this.recordStat('backend_queries_status',l);}if(c('FacebarGlobalOptions').taSessionLoggingSample){var m=[];this.results.forEach(function(r){m.push([r.text||'',r.category||'',r.subtext||'']);});this.recordStat('raw_suggestions_text',m);}var n=this.stats;for(var o in this.avgStats){var p=this.avgStats[o];n[o]=p[0]/p[1];}for(var q in this.appendStats)n[q]=JSON.stringify(this.appendStats[q]);return n;};i.prototype.buildResults=function(){'use strict';var k=(this.results||[]).map(function(l,m){var n=c('TokenizeUtil').parse(this.data.getTextToIndex(l)).tokens,o=l.rankType||l.render_type||l.type,p=l.bootstrapped?1:0,q=l.s_token||'',r=typeof l.index=='undefined'?100:l.index,s=j(n,this.query)||this.query,t=l.index_rank,u=l.match_type,v=l.l_type,w=l.vertical_type,x=l.prefix_match,y=l.prefix_length,z=l.text,aa=l.category,ba=l.subtext,ca=l.fromCache,da=l.isNullState,ea=l.isSingleState,fa=l.logInfo;if(typeof l.groupIndex=='number')return [l.groupIndex,l.indexInGroup,l.uid,o,p,q,s,t,u,x,y,l.origIndex,v,w,z,aa,ba,r,ca,da,ea,fa];return [0,m,l.uid,o,p,q,s,t,u,x,y,l.origIndex,v,w,z,aa,ba,r,ca,da,ea,fa];}.bind(this));return JSON.stringify(k);};i.prototype.submit=function(){'use strict';var k=this._dataToSubmit();switch(this.data.recordingRoute){case 'banzai_vital':c('Banzai').post(this._banzaiRoute,k,{delay:0,retry:true});break;default:this.submitThroughAsyncRequest(k);}this._reset();};i.prototype.addLatencyToSample=function(k,l,m,n){'use strict';k.addInteger(n+'query_start',m.queryStart);k.addInteger(n+'query_end',m.queryEnd);k.addInteger(n+'keypress_query_end',m.keyPressToQueryEnd);k.addInteger(n+'render',m.render);k.addInteger(n+'keypress_render',m.keyPressToRender);l[n+'query_start']=m.queryStart;l[n+'query_end']=m.queryEnd;l[n+'keypress_query_end']=m.keyPressToQueryEnd;l[n+'render']=m.render;l[n+'keypress_render']=m.keyPressToRender;};i.prototype.logToScuba=function(k,l,m,n,o){'use strict';var p={},q=new (c('BanzaiScuba'))('search_facebar_js',null,{addBrowserFields:true,addPredictedGeographyFields:true,addUser:true,addSearchVersion:true,addGatekeepers:{facebarGKs:true}});q.addInteger('sample_rate',m.sample_rate);p.sample_rate=m.sample_rate;q.addNormal('site',m.site);p.site=m.site;q.addDenorm('query',n);p.query=n;var r=k.payload||{};if(r.entities){q.addInteger('num_entities',r.entities.length);p.num_entities=r.entities.length;}Object.keys(this.performanceTimings).forEach(function(t){q.addInteger(t,this.performanceTimings[t]);p[t]=this.performanceTimings[t];}.bind(this),this);if(r.results||r.entries){var s=(r.results||r.entries).length;q.addInteger('num_results',s);p.num_results=s;}if(r.gzipped_payload_size!==undefined){q.addInteger('gzipped_payload_size',r.gzipped_payload_size);p.gzipped_payload_size=r.gzipped_payload_size;}if(l.recv&&l.render>l.recv){q.addInteger('time_render',l.render-l.recv);p.time_render=l.render-l.recv;q.addInteger('time_js_async',l.recv);p.time_js_async=l.recv;}if(l.payload_size){q.addInteger('payload_size',l.payload_size);p.payload_size=l.payload_size;}if(this.stats.time_render_null_state&&(!n||n.length===0)){q.addInteger('time_render_null_state',this.stats.time_render_null_state);p.time_render_null_state=this.stats.time_render_null_state;}q.addInteger('query_id',k.queryId);p.query_id=k.queryId;q.addDenorm('user_id',c('CurrentUser').getID());p.user_id=c('CurrentUser').getID();q.addDenorm('session_id',this.stats.sid);p.session_id=this.stats.sid;q.addNormal('typeahead_type',o);p.typeahead_type=o;if(l.remoteQueryLatencies){this.addLatencyToSample(q,p,l.remoteQueryLatencies,'remote_');q.addInteger('remote_keypress_query_dispatch',l.remoteQueryLatencies.keyPressToQueryDispatch);p.remote_keypress_query_dispatch=l.remoteQueryLatencies.keyPressToQueryDispatch;q.addInteger('remote_keypress_query_start',l.remoteQueryLatencies.keyPressToQueryStart);p.remote_keypress_query_start=l.remoteQueryLatencies.keyPressToQueryStart;q.addNormal('inflight_requests',l.remoteQueryLatencies.inflightRequests);q.addInteger('inflight_requests',l.remoteQueryLatencies.inflightRequests);p.inflight_requests=l.remoteQueryLatencies.inflightRequests;q.addNormal('waiting_queries',l.remoteQueryLatencies.waitingQueries);q.addInteger('waiting_queries',l.remoteQueryLatencies.waitingQueries);p.waiting_queries=l.remoteQueryLatencies.waitingQueries;}if(l.cacheQueryLatencies)this.addLatencyToSample(q,p,l.cacheQueryLatencies,'cache_');q.post();c('BanzaiNectar').log('search_facebar_js','typeahead',p);};i.prototype.submitThroughAsyncRequest=function(k){'use strict';if(Object.keys(k).length>0)new (c('AsyncRequest'))().setURI(this._endPoint).setMethod('POST').setData({stats:k}).setOption('handleErrorAfterUnload',true).setErrorHandler(function(l){k.retry=true;new (c('AsyncRequest'))().setURI(this._endPoint).setMethod('POST').setData({stats:k}).setOption('asynchronous_DEPRECATED',false).send();}.bind(this)).send();};var j=function k(l,m){if(!l||!m)return;var n=c('TokenizeUtil').parse(m);if(n.flatValue[n.flatValue.length-1]===' ')return n.flatValue;var o=n.tokens[n.tokens.length-1],p={};l.forEach(function(u){p[u]=(p[u]||0)+1;});var q={},r=n.tokens.slice(0,n.tokens.length-1);r.forEach(function(u){q[u]=(q[u]||0)+1;});for(var s=0;s<l.length;++s){var t=l[s];if(t.indexOf(o)===0&&p[t]-(q[t]||0)>0){r.push(t);return r.join(' ');}}return undefined;};Object.assign(i.prototype,{_endPoint:'/ajax/typeahead/record_metrics.php',_banzaiRoute:'search'});f.exports=i;}),null);
__d("XSearchFacebarSurveyController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/search\/facebar_survey\/",{id:{type:"String",required:true},query:{type:"String"},session_id:{type:"String",required:true},on_session_start:{type:"Exists",defaultValue:false},result_selected:{type:"Exists",defaultValue:false}});}),null);
__d('AbandonedSessionSurvey',['AsyncRequest','SubscriptionsHandler','XSearchFacebarSurveyController','getOrCreateDOMID'],(function a(b,c,d,e,f,g){function h(i){'use strict';this.tryToSubmitSurvey=function(){if(this.searchBoxFocused){this.openSurvey();this.resultSelected=false;this.searchBoxFocused=false;}}.bind(this);this.core=i.getCore();this.data=i.getData();this.view=i.getView();this.subscriptionsHandler=new (c('SubscriptionsHandler'))();}h.prototype.enable=function(){'use strict';this.subscriptionsHandler.addSubscriptions(this.core.subscribe('focus',function(){this.searchBoxFocused=true;this.resultSelected=false;}.bind(this)),this.data.subscribe('beforeQuery',function(i,j){this.query=j.value||'';}.bind(this)),this.view.subscribe('select',function(){this.resultSelected=true;this.tryToSubmitSurvey();}.bind(this)),this.core.subscribe('blur',this.tryToSubmitSurvey));};h.prototype.disable=function(){'use strict';this.subscriptionsHandler.release();this.request&&this.request.abort();};h.prototype.openSurvey=function(){'use strict';if(this.openedSurvey)return;this.openedSurvey=true;var i=this.core.element;if(i==null)i=this.core.getElement();var j=this.normalizeValue(this.query),k=c('XSearchFacebarSurveyController').getURIBuilder().setString('id',c('getOrCreateDOMID')(i)).setString('query',j!=null?j:'').setString('session_id',this.data.queryData.sid).setExists('result_selected',this.resultSelected);this.request=new (c('AsyncRequest'))().setMethod('post').setAllowCrossPageTransition(true).setURI(k.getURI());this.request.send();};h.prototype.normalizeValue=function(i){'use strict';return String(i).trim().replace(/\s+/g,' ').replace(/[\u200E|\u200F|\u202a|\u202b|\u202c]/g,'').toLowerCase();};f.exports=h;}),null);