var isIE=(navigator.appName.indexOf("Microsoft")!=-1);var isIE6=(navigator.appVersion.indexOf("MSIE 6")!=-1);var isIE7=(navigator.appVersion.indexOf("MSIE 7")!=-1);var isIE9=(navigator.appVersion.indexOf("MSIE 9")!=-1);var isSafari=(navigator.appVersion.indexOf("Safari")!=-1&&navigator.appVersion.indexOf("Chrome")==-1);var browser=getBrowser();var countRandomLogs=0;var correction;var clientCode;var againCheck=false;var emailforLOG="";var commforLOG="";var ratingforLOG="";var autoReplace=0;var langDetected;var dialogObj;var initialRating;var g_docrange;var logAlready=false;var UI=0;var SAC=0;var MSAC=0;var AC=0;var OM=0;var UN=0;var checkagain=false;var foreignLang=false;var foreignLangCode="other";var textBeforeReplace="";var stopspell=false;var Timer;var TotalSeconds;var intervalid;var _fbConnected=false;var _fbPopup=null;var _fbAllowed=true;function getCookie(B){B=cookieDomain+B;var A=document.cookie.match("(^|;) ?"+B+"=([^;]*)(;|$)");if(A){return(unescape(A[2]))}else{return null}}window.onload=function(){if(!minversion){$("#startText").focus();$("#startText").select();if(isIE){$("#spellSection").css("height",isIE?"413px":"381px");$(".searchcontent").css("height",isIE?"413px":"382px")}if($("#startText")!=null&&$("#startText").val()!=""&&$("#startText").val()!=intext){$("#btnSpell").focus();if($("#origin").val()!="admin"){if(($("#postsource").val()!="changespell"&&$("#postsource").val()!="")||$("#origin").val()=="reverso"){$("#imgLoad").css("display","block");document.getElementById("btnSpell").className="focused";if($("#postsource").val()=="otherspell"){if($("#force").val()=="true"){stopspell=true}spellCheck(true,false)}else{spellCheck(false,false)}}}}}};function spellCheckMin(){var A="";if($("#startText")!=null&&$("#startText").val()!=""){A=$("#startText").val()}if($("#inside").text()!=""){A=$("#inside").text()}if($.trim(A)!=""){if($("#imgLoad").css("display")=="none"){$("#imgLoad").css("display","block")}A=$.trim(A);A=A.replace(/((\r\n)+)|(\n+)/g,"\n");A=RemoveSingleBreakline(A);$("#originalText").val(A);SendToWS(spellRoot,document.getElementById("clientCode").value,A,correctionLang,interfaceLang,"both")}}function spellCheck(C,B){document.getElementById("btnSpell").className="copier";$(".rating").val("-1").change();$(".ui-rating").children().removeClass("ui-rating-full");$(".ui-rating").children().each(function(){if($(this).hasClass("ui-rating-empty")==false){$(this).addClass("ui-rating-empty")}});if($("#startText")!=null&&$("#startText").val()!=""&&$("#startText").val()!=intext){if($("#imgLoad").css("display")=="none"){$("#imgLoad").css("display","block")}logAlready=false;var A=$("#startText").val().replace(/</g,"");$("#replacemade").css("display","none");foreignLang=B||stopspell;if(stopspell==false&&enableDetection=="true"&&C==false&&A.match(/\b[\w'Ã€-Ã¿]+\b/g)!=null&&A.match(/\b[\w'Ã€-Ã¿]+\b/g).length>3){DetectLgAndRun(A)}else{SpellSpecifiedLang(correctionLang)}}else{alert(emptyBox)}return false}function DetectLgAndRun(A){A=A.replace(/\'/g,"&#39;");A=A.replace(/\\/g,"\\\\");$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:proxy+"/GetLgDetect",data:"{'text': '"+A+"'}",dataType:"json",success:function(B){if(B.d!=null&&B.d!=""){foreignLangCode=B.d;SpellSpecifiedLang(B.d)}else{SpellSpecifiedLang(correctionLang)}},error:function(B){alert("language detection error")}})}function SpellSpecifiedLang(C){$("#detection").css("display","none");$("#spell_available").css("display","none");$("#spellSection").css("height",isIE?"413px":"381px");switch(C){case"en":if(correctionLang=="fr"){$("#spellSection").css("height",isIE?"482px":"450px");$("#spell_available").css("display","block");$("#imgLoad").css("display","none");foreignLang=true;setTimeout("ChangeSpelling('en',true,false)",5000);CreateDownTimer("lblsec",5);return false}break;case"fr":if(correctionLang=="en"){$("#spellSection").css("height",isIE?"482px":"450px");$("#spell_available").css("display","block");$("#imgLoad").css("display","none");foreignLang=true;setTimeout("ChangeSpelling('fr',true,false)",5000);CreateDownTimer("lblsec",5);return false}break;default:$("#spellSection").css("height",isIE?"456px":"450px");$("#detection").css("display","block");$("#imgLoad").css("display","none");$("#textCorect").css("display","none");foreignLang=true;stopspell=true;return false;break}var A=$("#startText").val().replace(/</g,"");A=A.replace(/((\r\n)+)|(\n+)/g,"\n");A=RemoveSingleBreakline(A);$("#divinfo").css("display","none");$(".bottominfo").css("display","none");if(A.length>fr_limit&&correctionLang=="fr"){A=GetTruncatedText(A,fr_limit);$("#warning").css("display","block")}if(A.length>en_limit&&correctionLang=="en"){A=GetTruncatedText(A,en_limit);$("#warning").css("display","block")}autoReplace=0;textBeforeReplace=A;if($("#accents")!=null){$("#accents").css("display","none")}$("#originalText").val(A);$("#startText").val(A);checkagain=false;var B="both";if(correctionLang=="en"){B=GetDictOption();if(B=="none"){alert(selectDictError);$("#imgLoad").css("display","none");return false}}SendToWS("SpellerRequests.aspx",document.getElementById("clientCode").value,A,correctionLang,interfaceLang,B);stopspell=false}function SendToWS(B,D,G,E,A,C){xmlhttp=get_XmlHttp();if(xmlhttp!=null){xmlhttp.open("post",B,true);if(browser==1){G=escape(G);xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=windows-1252")}else{xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8")}G=G.replace(/&/g,"AMP-CODE");var F="passPhrase="+D+"&inputstring="+G+"&language="+E+"&interfLang="+A+"&dictionary="+C+"&lang="+A;if(navigator.appVersion.indexOf("Safari")==-1){xmlhttp.setRequestHeader("Content-length",F.length);xmlhttp.setRequestHeader("Connection","close")}xmlhttp.onreadystatechange=OnComplete_wsResult;xmlhttp.send(F)}else{alert(browserErr)}}function OnComplete_wsResult(){if(xmlhttp.readyState==4){if(xmlhttp.status==200){if(xmlhttp.responseXML==null||xmlhttp.responseXML.documentElement==null){if(xmlhttp.responseText!=null){if(xmlhttp.responseText=="1"){alert(service_message)}else{if(xmlhttp.responseText=="Timeout"){alert(timeOut)}else{alert(refresh_mess)}}}else{alert(service_message)}$("#imgLoad").css("display","none");var A=new SOAPClientParameters();SOAPClient.invoke(proxy,"GetClientPass",A,false,GetClient_callBack);return false}else{if(minversion){CheckSpelling_callBack_min(xmlhttp.responseXML.documentElement)}else{CheckSpelling_callBack(xmlhttp.responseXML.documentElement);ReloadSpellXiti("speller_result")}}}else{alert(service_message);$("#imgLoad").css("display","none");var A=new SOAPClientParameters();SOAPClient.invoke(proxy,"GetClientPass",A,false,GetClient_callBack)}}}function get_XmlHttp(){var C=null;if(window.XMLHttpRequest){C=new XMLHttpRequest()}else{if(window.ActiveXObject){try{C=new ActiveXObject("Microsoft.XMLHTTP")}catch(D){C=new ActiveXObject("Msxml2.XMLHTTP")}}}return C}function CheckSpelling_callBack(L){if($(L).find("textreplaced")!=null&&$(L).find("textreplaced").text()!=""){document.getElementById("startText").value=$(L).find("textreplaced").text();document.getElementById("originalText").value=$(L).find("textreplaced").text()}if($(L).find("noreplace")!=null&&$(L).find("noreplace").text()!=""){autoReplace=$(L).find("noreplace").text()}var C=$("#startText").val();$("#sourcetext").val(C);$("#flags").css("display","block");$("#btnCopy").css("display","block");$("#facebookDiv").css("display","block");var f=C;if($(L).find("newPassPhrase")!=null&&$(L).find("newPassPhrase").text()!=""){$("#clientCode").val($(L).find("newPassPhrase").text())}else{var e=new SOAPClientParameters();SOAPClient.invoke(proxy,"GetClientPass",e,false,GetClient_callBack)}var Z=L.getElementsByTagName("sentence");$("#btnClear").css("display","block");$("#ratingSection").css("display","block");document.getElementById("replacemade").style.display=(autoReplace>0?"":"none");if(Z.length==0){if(autoReplace>0){$("#replacemade").css("display","block")}else{$("#replacemade").css("display","none");if(againCheck){$("#textCorect2check").css("display","block");$("#textCorect").css("display","none")}else{$("#textCorect").css("display","block")}}correction="no corrections";againCheck=true;CompleteSearch(C)}else{$("#textCorect").css("display","none");$("#textCorect2check").css("display","none");$("#btnEdit").css("display","block");if($("#btnPaste")!=null){$("#btnPaste").css("display","none")}var N=0;var T=false;SAC=0;MSAC=0;AC=0;OM=0;UI=0;UN=0;correction="Minor";for(var Y=Z.length-1;Y>=0;Y--){var F=Z[Y].getAttribute("language");if(F!=null&&F.toLowerCase()=="unknown"){T=true}var V=Z[Y].getElementsByTagName("error");if(V.length!=0){for(var W=V.length-1;W>=0;W--){var a=V[W].getAttribute("proba");var E=V[W].getAttribute("type");var g=V[W].getAttribute("markunsure");if((a>=30&&E!="spell")||(E=="spell")){var R=V[W].getElementsByTagName("alternative");var d=$(V[W]).find("message");var b=d.text();if(b.indexOf(paronimeError)==-1){b=b.replace(/#!/g,"&lt;b&gt;").replace(/#\$/g,"&lt;/b&gt;");againCheck=false;if(E=="grammar"||E=="spell"){correction="Major"}var G=V[W].getAttribute("start");var D=V[W].getAttribute("end");var U=f.substring(G,D);U=U.replace(/\'/g,"&#39;");var M="s"+Y+"e"+W;if(R.length==0&&a>=0&&a<50&&E=="spell"){var I='<span tooltip="'+b.replace(/"/g,"''")+'" onmouseover="showtooltip(this,300);" onmouseout="hideddrivetip();" style="text-decoration:none;background-color:yellow;" >'+U+"</span>";C=C.substring(0,G)+I+C.substring(D);UN++;N++}var K=V[W].getAttribute("substitution");if(R.length!=0&&E!="spaceaddition"){var J=0;var c=U;if(K!=""){c=K;if(a<=75){c=$(R[0]).text();if((R.length>1)&&((c==U&&E!="spell")||(a>=50&&E=="spell"))){c=$(R[1]).text()}if(U==c&&correctionLang=="fr"){J=1}}}var O="sac";if(correctionLang=="fr"){if(c==U){O="msac";MSAC++}else{O="sac";SAC++}}else{if(g=="true"){if(K==$(R[0]).text()){O="sac_image";AC++}else{O="sac_image_o";OM++}}else{if(K==$(R[0]).text()){O="sac";SAC++}else{O="msac";MSAC++}}}var B=CreatenewDIV(M);for(var X=J;X<R.length;X++){var A=$(R[X]).text();if(correctionLang=="fr"){B.innerHTML+="<span onclick='ReplaceWord(this,\""+M+'","'+U+"\");'>"+A+"</span><br/>"}else{var Q=$(R[X]).attr("definition");Q=Q.replace(/\'/g,"&#39;");var H=$(R[X]).attr("class");if(Q.length+A.length<=30){B.innerHTML+="<span "+(H!=undefined?"class='"+H+"' ":"")+" onclick='ReplaceWord(this,\""+M+'","'+U+"\");' >"+A+"</span>"+(Q=="-"?"":" - ")+"<span style='text-decoration:none;'>"+Q+"</span><br/>"}else{B.innerHTML+="<span "+(H!=undefined?"class='"+H+"' ":"")+" onclick='ReplaceWord(this,\""+M+'","'+U+"\");'>"+A+"</span>"+(Q=="-"?"":" - ")+"<span title='"+Q+"' style='text-decoration:none;'>"+Q.substring(0,25)+"...</span><br/>"}}}if(correctionLang=="fr"){B.innerHTML+='<span class="elinks" onclick="Rolback(this,'+G+","+D+');">'+lnkRevenir+"</span><br/>"}B.innerHTML+='<span class="elinks" onclick="Hide(this);">'+lnkFermer+"</span><br/>";B.innerHTML+='<span class="elinks" onclick="Lookup(this);">'+lnkConsult+"</span>";document.getElementById("dinamic").appendChild(B);var P='<span id="span'+M+'" tooltip="'+b.replace(/"/g,"''")+'" onmouseover="showtooltip(this,300);" onmouseout="hideddrivetip();" class="'+O+'" onclick="SetVisible(this);">'+c+"</span>";C=C.substring(0,G)+P+C.substring(D);N++}K=K.replace(/\'/g,"&#39;");if(a>75&&K!=""){if(R.length==0&&b.indexOf(extraspaceError)==-1&&K!=U){var S='<span id="span'+M+'" onclick="SetVisible(this);" style="color:blue;" tooltip="'+b.replace(/"/g,"''")+'" onmouseover="showtooltip(this,300);" onmouseout="hideddrivetip();" >'+K+"</span>";C=C.substring(0,G)+S+C.substring(D);var B=CreatenewDIV(M);B.innerHTML+='<span class="elinks" onclick="Rolback(this,'+G+","+D+');">'+lnkRevenir+"</span><br/>";B.innerHTML+='<span class="elinks" onclick="Hide(this);">'+lnkFermer+"</span><br/>";B.innerHTML+='<span class="elinks" onclick="Lookup(this);">'+lnkConsult+"</span>";document.getElementById("dinamic").appendChild(B);AC++;N++}if(b.indexOf(extraspaceError)!=-1){C=C.substring(0,G)+K+C.substring(D);N++;$("#removespace").css("display","block")}}if(correctionLang=="en"&&R.length==0){var S='<span style="text-decoration:none;background-color:yellow;" tooltip="'+b+'" onmouseover="showtooltip(this,300);" onmouseout="hideddrivetip();" >'+U+"</span>";C=C.substring(0,G)+S+C.substring(D);UN++;N++}if(correctionLang=="en"&&E=="spaceaddition"){C=C.substring(0,G)+K+C.substring(D);N++;$("#textNeedSpace").css("display","block")}}}}}}if(N>0){document.getElementById("inside").innerHTML=C.replace(/\n/g,"<br />");$("#sourcetext").val($("#inside").text());$("#btnSpell").css("display","none");$("#after").css("display","block");$("#legend").css("display","block");document.getElementById("inside").style.borderColor="#4E9258";document.getElementById("btnNouveau").style.display=(correctionLang=="fr"?"":"none");if(T&&$("#originalText").val().split(" ").length>3){$("#unknownlang").css("display","block")}else{$("#unknownlang").css("display","none")}}else{correction="no corrections";if(autoReplace<=0){if(againCheck){$("#textCorect2check").css("display","block");$("#textCorect").css("display","none")}else{$("#textCorect").css("display","block")}}}CompleteSearch($("#sourcetext").val())}$("#imgLoad").css("display","none");if($("#origin").val()!="reverso"){if(googletag){googletag.pubads().refresh()}}else{$("#lnkBack").css("display","block")}return false}function GetClient_callBack(A){$("#clientCode").val(A)}function CompleteSearch(C){var B=C.split(" ");for(var A=0;A<B.length;A++){if(B[A].length>=4){if(B[A].indexOf("'")!=-1){if(B[A].split("'")[0].length>=4){$("#txtsearch").val(B[A].split("'")[0]);break}else{if(B[A].split("'")[1].length>=4){$("#txtsearch").val(B[A].split("'")[1]);break}}}else{$("#txtsearch").val(B[A]);break}}}}function CreatenewDIV(B){var A=document.createElement("div");A.setAttribute("id","div"+B);A.setAttribute("class",(correctionLang=="fr"?"upperwindowfr":"upperwindowen"));if(isIE||isIE6){A.style.zIndex="300";A.style.position=(isIE7?"fixed":"absolute");A.style.backgroundColor="#F0F9FE";A.style.width="100px";A.style.border="solid 1px #000";A.style.filter="alpha(opacity = 80)"}A.style.display="none";return A}function SetVisible(C){hideddrivetip();var B=document.getElementById("dinamic").getElementsByTagName("div");var D=C.id.replace("span","");document.getElementById("div"+D).style.left=findPos(C)[0]+"px";document.getElementById("div"+D).style.top=(findPos(C)[1]+20)+"px";document.getElementById("div"+D).style.display="";for(var A=0;A<B.length;A++){if(B[A].id!="div"+D){B[A].style.display="none"}}}function SetVisibleModal(C){var B=document.getElementById("dinamic").getElementsByTagName("div");var D=C.id.replace("span","");document.getElementById("div"+D).style.left=isIE7?(C.getBoundingClientRect().left):(C.offsetLeft+20)+"px";document.getElementById("div"+D).style.top=isIE7?(C.getBoundingClientRect().top+15):(C.offsetTop+42)+"px";document.getElementById("div"+D).style.display="";for(var A=0;A<B.length;A++){if(B[A].id!="div"+D){B[A].style.display="none"}}if(document.getElementById("div"+D)!=null&&(document.getElementById("div"+D).style.display==""||document.getElementById("div"+D).style.display=="block")){setTimeout("Hide('div"+D+"')",5000)}}function ReplaceWord(A,B){UI++;$("#span"+B).text($(A).text());document.getElementById("span"+B).className="ui";A.parentNode.style.display="none"}function Hide(A){if(A.tagName!=undefined&&A.tagName.toLowerCase()=="span"){document.getElementById(A.parentNode.id).style.display="none"}else{if(document.getElementById(A)!=null&&document.getElementById(A)!=undefined){document.getElementById(A).style.display="none"}}}function Lookup(C){var B=document.getElementById("span"+C.parentNode.id.replace("div","")).innerText;if(B==undefined){B=document.getElementById("span"+C.parentNode.id.replace("div","")).textContent}var A=dictURL+B;window.open(A)}function Rolback(D,A,C){UI++;var B=document.getElementById("originalText").value.substring(A,C);var E=document.getElementById("span"+D.parentNode.id.replace("div",""));if(E.innerText!=undefined){E.innerText=B}else{E.textContent=B}E.style.color="";E.className="ui";document.getElementById(D.parentNode.id).style.display="none"}function EditArea(B){if($("#origin")==null||$("#origin").val()!="admin"){if(B=="inside"){ColectInfo();logAlready=true}else{$("#lnkBack").css("display","none")}}$("#origin").val("");$("#btnSpell").css("display","block");$("#after").css("display","none");$("#legend").css("display","none");$("#btnClear").css("display","none");$("#ratingSection").css("display","none");$("#warning").css("display","none");$("#spellSection").css("height",isIE?"413px":"381px");if(isIE&&correctionLang=="fr"){$("#spellSection h1").css("padding-bottom","0px")}$("#flags").css("display","none");$("#facebookDiv").css("display","none");$("#divinfo").css("display","block");$(".bottominfo").css("display","block");var A=document.createElement("textarea");A.setAttribute("id","startText");A.setAttribute("width","462px");A.setAttribute("height","178px");if(B==null||B==""){if(!checkagain){ReloadSpellXiti("speller_new")}A.value=""}else{if(!checkagain&&B=="originalText"){ReloadSpellXiti("speller_original")}else{if(!checkagain&&B=="inside"){ReloadSpellXiti("speller_modifier")}}if(B=="inside"){if(browser!=1){document.getElementById(B).innerHTML=document.getElementById(B).innerHTML.replace(/<br \/>/g,"\n").replace(/<br>/g,"\n").replace(/<br\/>/g,"\n")}}A.value=(document.getElementById(B).value!=undefined?document.getElementById(B).value:(browser==1?document.getElementById(B).innerText:document.getElementById(B).textContent));if(browser!=1){A.value=A.value.replace(/\n/g,"<br>").replace(/\s+/g," ").replace(/<br>/g,"\n")}}document.getElementById("inside").innerHTML="";document.getElementById("inside").appendChild(A);document.getElementById("dinamic").innerHTML="";$("#textCorect").css("display","none");$("#textCorect2check").css("display","none");$("#replacemade").css("display","none");$("#removespace").css("display","none");$("#textNeedSpace").css("display","none");$("#btnEdit").css("display","none");if(browser==1){$("#btnPaste").css("display","block")}$("#btnCopy").css("display","none");$("#btnNouveau").css("display","none");$("#unknownlang").css("display","none");if($("#accents")!=null){$("#accents").css("display","block")}$(".grammairelinks").css("display","block");$("#detection").css("display","none");$("#spell_available").css("display","none");if(googletag){googletag.pubads().refresh()}return false}function DoTranslate(C){var D="";if(document.getElementById("startText")!=null){D=$("#startText").val()}else{D=$("#inside").text()}$("#sourcetext").val(D);var B="http://"+location.host+"/text_translation.aspx?lang="+interfaceLang.toUpperCase();var A="http://"+location.host+"/translationresults.aspx?lang="+interfaceLang.toUpperCase();if(C==""||C=="undefined"){postwith(B,{sourcetext:D})}else{postwith(A,{sourcetext:D,direction_translation:C,action_form:"translate"})}return false}function postwith(E,C){var B=document.createElement("form");B.setAttribute("method","POST");B.setAttribute("action",E);for(var A in C){var D=document.createElement("input");D.setAttribute("name",A);D.setAttribute("value",C[A]);D.setAttribute("type","hidden");B.appendChild(D)}document.body.appendChild(B);B.submit()}function Log(){var E=(document.getElementById("startText")==null?$("#inside").text():document.getElementById("startText").value);var F=(E==$("#sourcetext").val()||document.getElementById("startText")!=null?"":E);var B=getCookie("user_id");var C=GetDifNumber($("#originalText").val(),F==""?E:F);var A=C/$("#originalText").val().match(/\b[\w\'\Ã€-Ã¿]+\b/g).length*100;var D=new SOAPClientParameters();D.add("initial",textBeforeReplace);D.add("original",$("#originalText").val());D.add("corrected",$("#sourcetext").val());D.add("edited",UI==0?"":F);D.add("radio",ratingforLOG);D.add("comm",commforLOG);D.add("email",(emailforLOG==emailtext?"":emailforLOG));D.add("type",correction);D.add("ratio",A);D.add("user",((B!=null&&B!="")?"non-anonymous":"anonymous"));D.add("interf",interfaceLang);D.add("spell",correctionLang);D.add("automatic",autoReplace);D.add("origin",($("#origin")!="undefined"||$("#origin").val()!=""?$("#origin").val():"speller"));D.add("c_repl",SAC);D.add("c_orig",MSAC);D.add("c_auto",AC);D.add("c_unknown",UN);D.add("c_user",F==""?0:UI);D.add("c_enmark",OM);D.add("foreignLang",foreignLang);D.add("foreignLangCode",foreignLangCode);SOAPClient.invoke(proxy,"Loging",D,false,Log_callback)}function GetDifNumber(G,E){var H=/\b[\w'Ã€-Ã¿]+\b/g;var D=G.match(H);var A=E.match(H);var F=0;var I;for(var C=0;C<D.length;C++){for(var B=0;B<A.length;B++){if(D[C]==A[B]){F++;break}}}I=D.length-F;return I}function Log_callback(A){if(A==true){ResetElem()}}var count=0;function envoyer(A){if(!ValidateEmail()&&count++==0){return false}count=0;if(A=="onlyrating"){$("#serialStar").val(initialRating).change();ratingforLOG=initialRating;emailforLOG="";commforLOG="";dialogObj.dialog("close")}else{ReloadSpellXiti("speller_review_submit");ratingforLOG=$("#starsmodal option:selected").val();commforLOG=$("#comment").val();$("#succes").css("display","block");setTimeout("dialogObj.dialog('close');",2000)}return false}function textLimit(B,A){if(B.value.length>A+1){alert(maxSizeMess)}if(B.value.length>A){B.value=B.value.substring(0,A)}}function openRecom(){$("#recomander").dialog({height:440,width:400,title:recomTitle,modal:true,resizable:false,dialogClass:"recomdialog"});$(".recomdialog").css("top",$(".recomdialog").position().top-300);return false}function closeRecom(){$("#lblSucces").css("display","none");$("#lblError").css("display","none");$("#recomander").dialog("close");return false}function send(){var A=new SOAPClientParameters();A.add("name",$("#txtname").val());A.add("from",$("#txtFrom").val());A.add("to",$("#txtTo").val());A.add("body",$("#txtmes").val());SOAPClient.invoke(proxy,"SendEmail",A,false,SendEmail_callback);return false}function SendEmail_callback(A){if(A==true){$("#lblSucces").css("display","block");$("#lblError").css("display","none");setTimeout("closeRecom()",3000)}else{$("#lblSucces").css("display","none");$("#lblError").css("display","block")}ResetSend()}function ResetSend(){$("#txtname").val("");$("#txtFrom").val("");$("#txtTo").val("")}function ResetElem(){$("#comment").val("");$("#email").val(emailtext);$("#succes").css("display","none");ratingforLOG="";emailforLOG="";commforLOG=""}function ColectInfo(){if(!logAlready){if(getCookie("user_id")!=null||commforLOG!=""||ratingforLOG!=""||autoReplace>0||($("#sourcetext").val()!=$("#inside").text()&&$("#inside").text().trim()!=intext)){Log()}else{if(getCookie("user_id")==null&&commforLOG==""&&ratingforLOG==""&&autoReplace==0&&$("#sourcetext").val()==$("#inside").text()){countRandomLogs++;if(countRandomLogs==10){Log();countRandomLogs=0}}}}ResetElem();return false}function SpellAgain(){checkagain=true;EditArea("inside");spellCheck(true,false);return false}function findPos(B){var A=B.parentNode.scrollTop;var D=B.offsetLeft;var C=B.offsetTop;while(B.offsetParent){D=D+B.offsetParent.offsetLeft;C=C+B.offsetParent.offsetTop;if(B==document.getElementsByTagName("body")[0]){break}else{B=B.offsetParent}}return[D,C-A]}String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};function doCopy(){if(document.getElementById("startText")==null){document.getElementById("correctedText").value=$("#inside").text();doClipboard(document.getElementById("inside"),"Copy")}else{var A=document.getElementById("startText");A.select();if(document.all){var B=A.createTextRange();B.execCommand("Copy")}}return false}function doPaste(){if(document.all){var A=document.getElementById("startText");var B=A.createTextRange();B.execCommand("Paste")}return false}function doClipboard(B,A){if(document.all){var D=document.body.createTextRange();D.moveToElementText(B);D.select();var C=document.getElementById("correctedText").createTextRange();C.execCommand(A)}else{var D=document.createRange();D.setStartBefore(B);D.setEndAfter(B);window.getSelection().addRange(D)}}function addBookmarkForBrowser(){if(window.sidebar){window.sidebar.addPanel(document.title,document.location.href,"")}else{if(document.all){window.external.AddFavorite(document.location.href,document.title)}else{if(window.opera&&window.print){return true}}}}function isWhitespace(B){var A=/^\s+$/;if(A.test(B)){return true}return false}function ValidateEmail(){var B=document.getElementById("email").value;$("#emailerror").css("display","none");emailforLOG=B;if(B!=""&&B!=emailtext){var A=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;if(!A.test(B.trim())){emailforLOG="";$("#emailerror").style.display="";if(browser==1){event.returnValue=false}return false}}return true}function validate(){if(document.getElementById("txtname").value==""||isWhitespace(document.getElementById("txtname").value)){alert(askName);return false}var A=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;var C=document.getElementById("txtFrom").value;if(C==""||isWhitespace(C)){alert(askEmailExp);return false}if(!A.test(C.trim())){alert(askEmailExpInvalid);return false}var B=document.getElementById("txtTo").value;if(B==""||isWhitespace(B)){alert(askEmailDest);return false}if(!A.test(B.trim())){alert(askEmailDestInvalid);return false}if(document.getElementById("txtmes").value==""||isWhitespace(document.getElementById("txtmes").value)){alert(askMes);return false}send()}function accent(B){var A=$("#startText").getSelection();$("#startText").val($("#startText").val().substring(0,A.start)+B+$("#startText").val().substring(A.end));$("#startText").caret({start:A.start+1,end:A.start+1});$("#startText").focus()}function OpenModalWindow(){$("#serialStar option:eq(1)").text(star0).change();$("#serialStar option:eq(2)").text(star1).change();$("#serialStar option:eq(3)").text(star2).change();$("#serialStar option:eq(4)").text(star3).change();$(".rating").rating({showCancel:false,cancelValue:null});$(".ui-rating").click(function(){ReloadSpellXiti("speller_review");dialogObj=$("#dialog-modal").dialog({height:310,width:470,title:modalTitle,modal:true,resizable:false,close:function(A,B){if(ratingforLOG==""){$("#serialStar").val(initialRating).change();ratingforLOG=initialRating}ColectInfo();logAlready=true}});$(".translationRating").val($(".rating").val()).change();$("#comment").val("");$("#email").val(emailtext);$("#succes").css("display","none");$("#emailerror").css("display","none")})}function ViewRateWindow(){$("#starsmodal option:eq(0)").text(star0).change();$("#starsmodal option:eq(1)").text(star1).change();$("#starsmodal option:eq(2)").text(star2).change();$("#starsmodal option:eq(3)").text(star3).change();if($("#dialog-modal").css("display")!="none"){$(".translationRating").rating({showCancel:false,cancelValue:null})}$(".translationRating").val($(".rating").val()).change();$(".ui-rating").click(function(){initialRating=$(".rating").val();$(".rating").val($(".translationRating").val()).change();$("#lblRating").text($("#starsmodal option[value='"+$(".rating").val()+"']").text())})}function OpenSearch(B){var A=/[\S]/g;if(B.indexOf("conj")>=0&&($("#txtsearch").val()==""||!A.test($("#txtsearch").val()))){B=B.replace("-verb-{0}.html",".html");B=B.replace("-verbe-{0}.html",".html");B=B.replace("-verbo-{0}.html",".html")}B=B.replace("{0}",$("#txtsearch").val().trim());window.open(B)}function getBrowser(){if(navigator.appVersion.indexOf("MSIE")!=-1){return 1}if(navigator.appName=="Netscape"){if(navigator.userAgent.indexOf("Netscape6")!=-1){return 2}else{return 3}}return 0}function GetSelectedWordText(){if(browser==1||browser==6){return g_docrange.text}else{return g_docrange}}function CreateSelection(A){if(browser==1||browser==6){g_docrange=document.selection.createRange()}else{if(A=="txt"){document.onmouseup=function(){if(document.getElementById("startText")!=null){var C=document.getElementById("startText").selectionStart;var B=document.getElementById("startText").selectionEnd;g_docrange=document.getElementById("startText").value.substring(C,B)}}}else{GetFFSelection()}}}function doSelection(C){CreateSelection(C);if(g_docrange.text!=""&&g_docrange!=""){var B=GetSelectedWordText();$("#txtsearch").val(B).change()}}function GetFFSelection(){if(window.getSelection()){var A,B,E,C,D;A=window.getSelection();C=A.getRangeAt(0);E=C.toString().length;D=C.cloneRange();D.collapse(true);D.setStart(document.getElementById("inside"),0);B=D.toString().length+1;E=(E+D.toString().length);g_docrange=document.getElementById("inside").textContent.substring(B-1,E)}}function ReloadSpellXiti(C){var D=$("#imgXiti");Xt_h=new Date();Xt_param="s=454157&p="+correctionLang.toUpperCase()+C+"_"+interfaceLang.toUpperCase();try{Xt_r=top.document.referrer}catch(A){Xt_r=document.referrer}Xt_i="http://logv11.xiti.com/bcg.xiti?"+Xt_param;Xt_i+="&hl="+Xt_h.getHours()+"x"+Xt_h.getMinutes()+"x"+Xt_h.getSeconds();if(parseFloat(navigator.appVersion)>=4){Xt_s=screen;Xt_i+="&r="+Xt_s.width+"x"+Xt_s.height+"x"+Xt_s.pixelDepth+"x"+Xt_s.colorDepth}var B=Xt_i+"&ref="+Xt_r.replace(/[<>"]/g,"").replace(/&/g,"$");D.attr("src",B)}function spellmenu(A){var B=document.getElementById("divcontextual");B.style.left=(findPos(A)[0]+(isIE7||isIE9||isSafari?1:0))+"px";B.style.top=(findPos(A)[1]+(isIE7||isIE9?22:21))+"px";if(correctionLang=="en"){B.innerHTML="<span onclick=\"ChangeSpelling('fr',false,false);\">"+spellTextFr+"</span>"}else{B.innerHTML="<span onclick=\"ChangeSpelling('en',false,false);\">"+spellTextEn+"</span>"}B.style.display="";if(B!=null&&(B.style.display==""||B.style.display=="block")){setTimeout('Hide("divcontextual")',3000)}}function ChangeSpelling(A,D,B){var C=$("#originalText").val();if(document.getElementById("startText")!=null&&$("#startText")!="undefined"){C=$("#startText").val()}if(browser==1||browser==0){C=C.replace(/\r\n/g,"BR-HTML").replace(/\n/g,"BR-HTML")}switch(A){case"fr":switch($("#ddlInterface").val()){case"fr":postwith("http://"+location.host+"/orthographe/correcteur-francais/",{searchtext:C,postsource:(D==true?"otherspell":"changespell"),force:B});break;case"en":postwith("http://"+location.host+"/spell-checker/french-spelling-grammar/",{searchtext:C,postsource:(D==true?"otherspell":"changespell"),force:B});break;case"es":postwith("http://"+location.host+"/ortografia/corrector-frances/",{searchtext:C,postsource:(D==true?"otherspell":"changespell"),force:B});break}break;case"en":switch($("#ddlInterface").val()){case"fr":postwith("http://"+location.host+"/orthographe/correcteur-anglais/",{searchtext:C,postsource:(D==true?"otherspell":"changespell"),force:B});break;case"en":postwith("http://"+location.host+"/spell-checker/english-spelling-grammar/",{searchtext:C,postsource:(D==true?"otherspell":"changespell"),force:B});break;case"es":postwith("http://"+location.host+"/ortografia/corrector-ingles/",{searchtext:C,postsource:(D==true?"otherspell":"changespell"),force:B});break}break}return false}function ChangeInterface(){switch($("#ddlInterface").val()){case"fr":if(correctionLang=="fr"){location.pathname="/orthographe/correcteur-francais/"}else{location.pathname="/orthographe/correcteur-anglais/"}break;case"en":if(correctionLang=="fr"){location.pathname="/spell-checker/french-spelling-grammar/"}else{location.pathname="/spell-checker/english-spelling-grammar/"}break;case"es":if(correctionLang=="fr"){location.pathname="/ortografia/corrector-frances/"}else{location.pathname="/ortografia/corrector-ingles/"}break}}function GetTruncatedText(C,A){if(C.length>A){C=C.substring(0,A);var B=C.lastIndexOf(" ");C=C.substring(0,B)}return C}function GetDictOption(){if(document.getElementById("usDict").checked&&document.getElementById("ukDict").checked){return"both"}else{if(document.getElementById("usDict").checked&&!document.getElementById("ukDict").checked){return"us"}else{if(!document.getElementById("usDict").checked&&document.getElementById("ukDict").checked){return"uk"}else{return"none"}}}}function VerifyEnglishOpt(A){if(!document.getElementById("usDict").checked&&!document.getElementById("ukDict").checked){alert(selectDictError);A.checked=true;return false}}function fbInitCheckLogin(A){if(typeof (FB)!="undefined"&&FB!=null){if(!_fbConnected){FB.init({appId:facebookKey,status:true,cookie:true,xfbml:true,version:"v2.2"})}FB.getLoginStatus(function(B){if(B.status==="connected"){_fbConnected=true}if(A&&_fbConnected){FB.api("/me/permissions",function(C){for(var D=0;D<C.data.length;D++){if(C.data[D].permission=="publish_actions"&&C.data[D].status=="granted"){publishPost()}}})}})}else{alert(_fbErrorMsg)}}function fbComInit(){window.fbAsyncInit=function(){fbInitCheckLogin(false)};var A=(interfaceLang=="en"?"en_US":(interfaceLang=="es"?"es_ES":"fr_FR"));(function(E,B,F){var D,C=E.getElementsByTagName(B)[0];if(E.getElementById(F)){return }D=E.createElement(B);D.id=F;D.src="//connect.facebook.net/"+A+"/sdk.js";C.parentNode.insertBefore(D,C)}(document,"script","facebook-jssdk"))}function publishPost(){if(_fbConnected){var A={message:$("#sourcetext").val(),link:facebookLink,picture:"",name:facebookCaption,description:facebookDesc};FB.api("/me/feed","POST",A,function(B){if(!B||B.error){if(B.error.code==200&&B.error.type=="OAuthException"){fbLoginPost(fbpath)}else{alert(facebookError)}}else{alert(facebookSucces)}})}else{fbLoginPost(fbpath)}}function fbLoginPost(A){_fbPopup=window.open(A,"","width=650, height=300, location=0, status=0, fullscreen=0, resizable=0, scrollbars=0, toolbar=0");checkFbClosed()}function checkFbClosed(){if(_fbPopup!=null&&_fbPopup.closed){fbInitCheckLogin(true)}else{setTimeout("checkFbClosed()",1)}}function RemoveSingleBreakline(A){A=A.replace(/\r*\n{1}(\x20*[\da-zÃ -Ã¶Ã¸-Ã¿A-ZÅ Å’Å½Å¸Ã€-Ã–Ã˜-Ã?]{1}\.)/g,"A[{#1#2#3#}]A$1");A=A.replace(/\r*\n{1}(\x20*[\da-zÃ -Ã¶Ã¸-Ã¿A-ZÅ Å’Å½Å¸Ã€-Ã–Ã˜-Ã?]{1}\))/g,"A[{#1#2#3#}]A$1");A=A.replace(/([^\n\.!;:?\x20])\x20*\r*\n{1}\x20*([^\x20\r\n\-â€”\*â€¢A-ZÅ Å’Å½Å¸Ã€-Ã–Ã˜-Ã?])/g,"$1 $2");while(A.indexOf("A[{#1#2#3#}]A")>-1){A=A.replace("A[{#1#2#3#}]A","\n")}return A}function CheckSpelling_callBack_min(L){if($(L).find("textreplaced")!=null&&$(L).find("textreplaced").text()!=""){if(document.getElementById("startText")!=null){document.getElementById("startText").value=$(L).find("textreplaced").text()}document.getElementById("originalText").value=$(L).find("textreplaced").text()}if($(L).find("noreplace")!=null&&$(L).find("noreplace").text()!=""){autoReplace=$(L).find("noreplace").text()}var C=$.trim($("#originalText").val());var h=C;if($(L).find("newPassPhrase")!=null&&$(L).find("newPassPhrase").text()!=""){$("#clientCode").val($(L).find("newPassPhrase").text())}else{var f=new SOAPClientParameters();SOAPClient.invoke(proxy,"GetClientPass",f,false,GetClient_callBack)}var Z=L.getElementsByTagName("sentence");document.getElementById("replacemade").style.display=(autoReplace>0?"":"none");$("#dinamic").html("");if(Z.length==0){if(autoReplace==0){$("#textCorect").css("display","block")}$("#inside").html($("#inside").text())}else{$("#textCorect").css("display","none");var N=0;var T=false;correction="Minor";for(var Y=Z.length-1;Y>=0;Y--){var F=Z[Y].getAttribute("language");if(F!=null&&F.toLowerCase()=="unknown"){T=true}var V=Z[Y].getElementsByTagName("error");if(V.length!=0){for(var W=V.length-1;W>=0;W--){var a=V[W].getAttribute("proba");var E=V[W].getAttribute("type");var l=V[W].getAttribute("markunsure");if((a>=30&&E!="spell")||(E=="spell")){var R=V[W].getElementsByTagName("alternative");var d=$(V[W]).find("message");var b=d.text();if(b.indexOf(paronimeError)==-1){b=b.replace(/#!/g,"&lt;b&gt;").replace(/#\$/g,"&lt;/b&gt;");if(E=="grammar"||E=="spell"){correction="Major"}var G=V[W].getAttribute("start");var D=V[W].getAttribute("end");var U=h.substring(G,D);U=U.replace(/\'/g,"&#39;").replace(/\â€™/,"&#39;");var M="s"+Y+"e"+W;if(R.length==0&&a>=0&&a<50&&E=="spell"){var I='<span title="'+b.replace(/"/g,"''")+'" class=\'tooltip\' style="text-decoration:none;background-color:yellow;" >'+U+"</span>";C=C.substring(0,G)+I+C.substring(D);N++}var K=V[W].getAttribute("substitution");if(R.length!=0&&E!="spaceaddition"){var J=0;var c=U;if(K!=""){c=K;if(a<=75){c=$(R[0]).text();if((R.length>1)&&((c==U&&E!="spell")||(a>=50&&E=="spell"))){c=$(R[1]).text()}if(U==c&&correctionLang=="fr"){J=1}}}var O="sac";if(correctionLang=="fr"){if(c==U){O="msac"}else{O="sac"}}else{if(l=="true"){if(K==$(R[0]).text()){O="sac_image"}else{O="sac_image_o"}}else{if(K==$(R[0]).text()){O="sac"}else{O="msac"}}}var B=CreatenewDIV(M);B.innerHTML="";for(var X=J;X<R.length;X++){var A=(R[X].text!=undefined?R[X].text:R[X].textContent);if(correctionLang=="fr"){B.innerHTML+="<span onclick='ReplaceWord(this,\""+M+'","'+U+"\");'>"+A+"</span><br/>"}else{var Q=R[X].getAttribute("definition");var H=(R[X].getAttribute("class")!=undefined?R[X].getAttribute("class"):"");if(Q.length+A.length<=30){B.innerHTML+="<span class='"+H+"' onclick='ReplaceWord(this,\""+M+'","'+U+"\");' >"+A+"</span>"+(Q=="-"?"":" - ")+"<span style='text-decoration:none;'>"+Q.replace(/\'/g,"&#39;")+"</span><br/>"}else{B.innerHTML+="<span class='"+H+"' onclick='ReplaceWord(this,\""+M+'","'+U+"\");'>"+A+"</span>"+(Q=="-"?"":" - ")+"<span title='"+Q.replace(/\'/g,"&#39;")+"' style='text-decoration:none;' class='tooltip'>"+Q.substring(0,25)+"...</span><br/>"}}}if(correctionLang=="fr"){B.innerHTML+='<span class="elinks" onclick="Rolback(this,'+G+","+D+');">'+lnkRevenir+"</span><br/>"}B.innerHTML+='<span class="elinks" onclick="Hide(this);">'+lnkFermer+"</span><br/>";B.innerHTML+='<span class="elinks" onclick="Lookup(this);">'+lnkConsult+"</span>";document.getElementById("dinamic").appendChild(B);var P='<span id="span'+M+'" class="tooltip '+O+'" title="'+b.replace(/"/g,"''")+'" onclick="SetVisibleModal(this);" >'+c+"</span>";C=C.substring(0,G)+P+C.substring(D);N++}K=K.replace(/\'/g,"&#39;");if(a>75&&K!=""){if(R.length==0&&b.indexOf(extraspaceError)==-1&&K!=U){var S='<span id="span'+M+'" onclick="SetVisibleModal(this);" style="color:blue;" title="'+b.replace(/"/g,"''")+"\" class='tooltip' >"+K+"</span>";C=C.substring(0,G)+S+C.substring(D);var B=CreatenewDIV(M);B.innerHTML+='<span class="elinks" onclick="Rolback(this,'+G+","+D+');">'+lnkRevenir+"</span><br/>";B.innerHTML+='<span class="elinks" onclick="Hide(this);">'+lnkFermer+"</span><br/>";B.innerHTML+='<span class="elinks" onclick="Lookup(this);">'+lnkConsult+"</span>";document.getElementById("dinamic").appendChild(B);N++}if(b.indexOf(extraspaceError)!=-1){C=C.substring(0,G)+K+C.substring(D);N++;$("#removespace").css("display","block")}}if(correctionLang=="en"&&R.length==0){var S='<span style="text-decoration:none;background-color:yellow;" title="'+b+"\" class='tooltip' >"+U+"</span>";C=C.substring(0,G)+S+C.substring(D);N++}if(correctionLang=="en"&&E=="spaceaddition"){C=C.substring(0,G)+K+C.substring(D);N++;$("#textNeedSpace").css("display","block")}}}}}}if(N>0){$("#inside").html(C)}else{$("#inside").html($("#inside").text());$("#textCorect").css("display","block")}}$("#imgLoad").css("display","none");try{$("span").tooltip({track:true,showURL:false})}catch(g){}return false}function CreateDownTimer(B,A){Timer=document.getElementById(B);if(Timer!=null){TotalSeconds=A;UpdateTimer();intervalid=window.setInterval(function(){Tick()},1000)}}function Tick(){if(TotalSeconds<0){intervalid=window.clearInterval(intervalid);return }TotalSeconds-=1;UpdateTimer()}function UpdateTimer(){Timer.innerHTML=TotalSeconds}function DoSpell(B){if(isIE){B=event}if(B!=undefined){var A=(B.keyCode?B.keyCode:B.which);if(A==13&&$("#btnSpell").attr("tabindex")=="0"){$("#btnSpell").attr("tabindex",1);spellCheck(false,false)}}}document.onkeypress=DoSpell