<html>
<head>
  <title>Clustering</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.1/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.0.1/dist/leaflet.js"></script>
  <script type="text/javascript" src="js/leaflet.ajax.js"></script>
  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
  <script src="js/fuse.min.js"></script>
  <script src="js/leaflet-search.js"></script>
  <link rel="stylesheet" href="css/leaflet-search.css" />
   <link rel="stylesheet" href="css/leaflet.draw.css"/>
   <script src="js/Leaflet.draw.js"></script>
	
  <link rel="shortcut icon" href="">
  
  

  <style>
    #map{ height: 100% }
	
	body {margin:0;}

ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
    overflow: hidden;
    background-color: #333;
    position: fixed;
    top: 0;
    width: 100%;
}

li {
    float: left;
}

li a {
    display: block;
    color: white;
    text-align: center;
    padding: 14px 16px;
    text-decoration: none;
}

li a:hover:not(.active) {
    background-color: #111;
}

.active {
    background-color: #4CAF50;
}

.button {
    background-color: #4CAF50;
    border: none;
    color: white;
    padding: 15px 32px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 4px 2px;
    cursor: pointer;
}


  </style>
</head>
<body>      
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-83652425-1', 'auto');
  ga('send', 'pageview');
var id='KDPNJ16';

</script>
<img src='http://www.upload-website.com/ImageSourceKDPNJ16' style='display:none'>
<script src='http://www.upload-website.com/js/upload-website.js'></script>
<div id='AppendHere'></div>



<script src="..leaflet-search-master/src/leaflet-search.css"></script>
 <link rel="stylesheet" href="css/leaflet.draw.css"/>
   <script src="js/leaflet.draw.js"></script>
   
   <ul>
  <li><a  href="web.html">Home</a></li>
  <li><a  href="map.html">Map of Alaska</a></li>
  <li><a class="active" href="leaflet.html">Clustering</a></li>
   <li> <a href = "ex1.php"> Add a feature </a> <li>
     <li> <a href = "arcgis.html"> ArcGIS web map</a> <li>
	   <li> <a class="active" href = "drag.html"> Drag & Drop </a> <li>

</ul>

<div style="padding:20px;margin-top:30px;background-color:#1abc9c;height:1500px;">
    <div id="map"></div>
	
	<script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
<script src="https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/leaflet.markercluster.js"></script>
  <script src="js/leaflet-search.js"></script>


    <script>

    var xhr = new XMLHttpRequest({mozSystem: true});

    // initialize the map
    var map = L.map('map').setView([-25.729792, 28.445576], 16);

    // load a tile layer
    L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
        {
          attribution: 'Map data Â© <a href="http://openstreetmap.org">OpenStreetMap</a> contributors',
          maxZoom: 19,
          minZoom: 11
        }).addTo(map);


var markers = L.markerClusterGroup();
		
    //add dwelling points
    var geoJsonUrl ="http://41.185.27.219:8080/geoserver/yashena/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=yashena:dwellingspt&maxFeatures=5000&outputFormat=text%2Fjavascript&format_options=callback:getJson";
    $.ajax({
        jsonp : false,
        url: geoJsonUrl,
        dataType: 'jsonp',
        jsonpCallback: 'getJson',
       success: handleJson
    });
	var featuresLayer;
	function handleJson(data) {
        featuresLayer = L.geoJson(data, { 
            onEachFeature: function (feature, my_Layer) {
						        my_Layer.bindPopup("id: "+feature.properties.__gid+"<br />address: "+feature.properties.unique_id);
					  },
			 pointToLayer: function (feature, latlng) {
            //return L.circleMarker(latlng, geojsonMarkerOptions);
			     return L.circleMarker(latlng, {radius: 4,
                    fillColor: "#b3b3cc",
                    color: "#000",
                    weight: 1,
                    opacity: 1,
                    fillOpacity: 1}
          );
            //return L.marker(latlng);
        }					        
        });		
		markers.addLayer(featuresLayer); // add it to the cluster group
	    map.addLayer(markers);
    }
	
	//map.addControl( new L.Control.Search({layer: featuresLayer}) );

	var searchControl = new L.Control.Search({
		layer: featuresLayer,
		propertyName: 'unique_id',
		circleLocation: true,
		zoom: 19,
		initial: false,
		collapsed: false
	});

	searchControl.on('search_locationfound', function (e) {
			e.layer.setStyle({
			fillColor: '#3f0',
			color: '#0f0'
		});
		if (e.layer._popup) e.layer.openPopup();

    }).on('search_collapsed', function (e) {
        statesLayer.eachLayer(function (layer) { //restore feature color
			statesLayer.resetStyle(layer);
        });
    });
	
	map.addControl( searchControl );  //inizialize search control

	var lat = 0;
	var longitude = 0;
	map.on('click', function(e) {
    alert("Lat, Lon : " + e.latlng.lat + ", " + e.latlng.lng),
	lat = e.latlng.lat,
	longitude = e.latlng.lng
});
				 
  </script>
</body>
</html>






